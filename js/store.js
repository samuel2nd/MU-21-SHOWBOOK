// ============================================
// Central Data Store — Reactive state management
// ============================================

const Store = (() => {
  const STORAGE_KEY = 'mu21_showbook';
  const listeners = {};

  // ── MU-21 Router I/O — Default device library ──
  // Exact data from the RTR I/O MASTER SHEET Google Sheet.
  // Format: [deviceName, deviceDesc, videoLevel, audio1..audio16]
  // Empty strings for unused audio channels.
  function defaultRtrMaster() {
    const _D = [
      ['CCU 01','CCU 1 De-Embed 1-16','1','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16'],
      ['CCU 02','CCU 2 De-Embed 17-32','2','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32'],
      ['CCU 03','CCU 3 De-Embed 33-48','3','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48'],
      ['CCU 04','CCU 4 De-Embed 49-64','4','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64'],
      ['CCU 05','CCU 5 De-Embed 65-80','5','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80'],
      ['CCU 06','CCU 6 De-Embed 81-96','6','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96'],
      ['CCU 07','CCU 7 De-Embed 97-112','7','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112'],
      ['CCU 08','CCU 8 De-Embed 113-128','8','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128'],
      ['IN 009','NOT USED (DE-EMBED)','9'],
      ['CCU 09','CCU 9 De-Embed 145-160','10','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160'],
      ['CCU 10','CCU 10 De-Embed 161-176','11','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176'],
      ['CCU 11','CCU 11 De-Embed 177-192','12','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192'],
      ['CCU 12','CCU 12 De-Embed 193-208','13','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208'],
      ['FS 01','Frame Sync 01 209-224','14','209','210','211','212','213','214','215','216','217','218','219','220','221','222','223','224'],
      ['FS 02','Frame Sync 02 225-240','15','225','226','227','228','229','230','231','232','233','234','235','236','237','238','239','240'],
      ['FS 03','Frame Sync 03 241-256','16','241','242','243','244','245','246','247','248','249','250','251','252','253','254','255','256'],
      ['FS 04','Frame Sync 04 257-272','17','257','258','259','260','261','262','263','264','265','266','267','268','269','270','271','272'],
      ['IN 018','NOT USED (DE-EMBED)','18'],
      ['FS 05','Frame Sync 05 289-304','19','289','290','291','292','293','294','295','296','297','298','299','300','301','302','303','304'],
      ['FS 06','Frame Sync 06 305-320','20','305','306','307','308','309','310','311','312','313','314','315','316','317','318','319','320'],
      ['FS 07','Frame Sync 07 321-336','21','321','322','323','324','325','326','327','328','329','330','331','332','333','334','335','336'],
      ['FS 08','Frame Sync 08 337-352','22','337','338','339','340','341','342','343','344','345','346','347','348','349','350','351','352'],
      ['FS 09','Frame Sync 09 353-368','23','353','354','355','356','357','358','359','360','361','362','363','364','365','366','367','368'],
      ['FS 10','Frame Sync 10 369-384','24','369','370','371','372','373','374','375','376','377','378','379','380','381','382','383','384'],
      ['FS 11','Frame Sync 11 385-400','25','385','386','387','388','389','390','391','392','393','394','395','396','397','398','399','400'],
      ['FS 12','Frame Sync 12 401-416','26','401','402','403','404','405','406','407','408','409','410','411','412','413','414','415','416'],
      ['IN 027','NOT USED (DE-EMBED)','27'],
      ['FS 13','Frame Sync 13 433-448','28','433','434','435','436','437','438','439','440','441','442','443','444','445','446','447','448'],
      ['FS 14','Frame Sync 14 449-464','29','449','450','451','452','453','454','455','456','457','458','459','460','461','462','463','464'],
      ['FS 15','Frame Sync 15 465-480','30','465','466','467','468','469','470','471','472','473','474','475','476','477','478','479','480'],
      ['FS 16','Frame Sync 16 481-496','31','481','482','483','484','485','486','487','488','489','490','491','492','493','494','495','496'],
      ['FS 17','Frame Sync 17 497-512','32','497','498','499','500','501','502','503','504','505','506','507','508','509','510','511','512'],
      ['FS 18','Frame Sync 18 513-528','33','513','514','515','516','517','518','519','520','521','522','523','524','525','526','527','528'],
      ['FS 19','Frame Sync 19 529-544','34','529','530','531','532','533','534','535','536','537','538','539','540','541','542','543','544'],
      ['FS 20','Frame Sync 20 545-560','35','545','546','547','548','549','550','551','552','553','554','555','556','557','558','559','560'],
      ['IN 036','NOT USED (DE-EMBED)','36'],
      ['EVS 1-A','EVS 1-1 577-592','37','577','578','579','580','581','582','583','584','585','586','587','588','589','590','591','592'],
      ['EVS 1-B','EVS 1-2 593-608','38','593','594','595','596','597','598','599','600','601','602','603','604','605','606','607','608'],
      ['EVS 1-C','EVS 1-3 609-624(NOT USED)','39','609','610','611','612','613','614','615','616','617','618','619','620','621','622','623','624'],
      ['EVS 1-D','EVS 1-4 625-640(NOT USED)','40','625','626','627','628','629','630','631','632','633','634','635','636','637','638','639','640'],
      ['EVS 2-A','EVS 2-1 641-656','41','641','642','643','644','645','646','647','648','649','650','651','652','653','654','655','656'],
      ['EVS 2-B','EVS 2-2 657-672','42','657','658','659','660','661','662','663','664','665','666','667','668','669','670','671','672'],
      ['EVS 2-C','EVS 2-3 673-688(NOT USED)','43','673','674','675','676','677','678','679','680','681','682','683','684','685','686','687','688'],
      ['EVS 2-D','EVS 2-4 689-704(NOT USED)','44','689','690','691','692','693','694','695','696','697','698','699','700','701','702','703','704'],
      ['IN 045','NOT USED (DE-EMBED)','45'],
      ['EVS 3-A','EVS 3-1(CG 7) 721-736','46','721','722','723','724','725','726','727','728','729','730','731','732','733','734','735','736'],
      ['EVS 3-B','EVS 3-2(CG 8) 737-752','47','737','738','739','740','741','742','743','744','745','746','747','748','749','750','751','752'],
      ['EVS 3-C','EVS 3-3 753-768(NOT USED)','48','753','754','755','756','757','758','759','760','761','762','763','764','765','766','767','768'],
      ['EVS 3-D','EVS 3-4 769-784(NOT USED)','49','769','770','771','772','773','774','775','776','777','778','779','780','781','782','783','784'],
      ['FS 21','Frame Sync 21 785-800','50','785','786','787','788','789','790','791','792','793','794','795','796','797','798','799','800'],
      ['FS 22','Frame Sync 22 801-816','51','801','802','803','804','805','806','807','808','809','810','811','812','813','814','815','816'],
      ['FS 23','Frame Sync 23 817-832','52','817','818','819','820','821','822','823','824','825','826','827','828','829','830','831','832'],
      ['FS 24','Frame Sync 24 833-848','53','833','834','835','836','837','838','839','840','841','842','843','844','845','846','847','848'],
      ['IN 054','NOT USED (DE-EMBED)','54','849','850','851','852','853','854','855','856','857','858','859','860','861','862','863','864'],
      ['SPOT 1s','Spot 1 Character 865-880','55','865','866','867','868','869','870','871','872','873','874','875','876','877','878','879','880'],
      ['SPOT 2s','Spot 2 Character 881-896','56','881','882','883','884','885','886','887','888','889','890','891','892','893','894','895','896'],
      ['SPOT 3s','Spot 3 Character 897-912','57','897','898','899','900','901','902','903','904','905','906','907','908','909','910','911','912'],
      ['SPOT 4s','Spot 4 Character 913-928','58','913','914','915','916','917','918','919','920','921','922','923','924','925','926','927','928'],
      ['TX3 DA','TX3 DA 929-944','59','929','930','931','932','933','934','935','936','937','938','939','940','941','942','943','944'],
      ['TX4 DA','TX4 DA 945-960','60','945','946','947','948','949','950','951','952','953','954','955','956','957','958','959','960'],
      ['TX5 DA','TX5 DA 961-976','61','961','962','963','964','965','966','967','968','969','970','971','972','973','974','975','976'],
      ['TX6 DA','TX6 DA 977-992','62','977','978','979','980','981','982','983','984','985','986','987','988','989','990','991','992'],
      ['IN 063','NOT USED (DE-EMBED)','63'],
      ['TX7 DA','TX7 DA 1009-1024','64','1009','1010','1011','1012','1013','1014','1015','1016','1017','1018','1019','1020','1021','1022','1023','1024'],
      ['TX8 DA','TX8 DA 1025-1040','65','1025','1026','1027','1028','1029','1030','1031','1032','1033','1034','1035','1036','1037','1038','1039','1040'],
      ['CG 1','(ABOVE TAPE RACK)CG 1 1041-1056','66','1041','1042','1043','1044','1045','1046','1047','1048','1049','1050','1051','1052','1053','1054','1055','1056'],
      ['CG 2','(ABOVE TAPE RACK)CG 2 1057-1072','67','1057','1058','1059','1060','1061','1062','1063','1064','1065','1066','1067','1068','1069','1070','1071','1072'],
      ['CG 3','(ABOVE TAPE RACK)CG 3 1073-1088','68','1073','1074','1075','1076','1077','1078','1079','1080','1081','1082','1083','1084','1085','1086','1087','1088'],
      ['CG 4','(ABOVE TAPE RACK)CG 4 1089-1104','69','1089','1090','1091','1092','1093','1094','1095','1096','1097','1098','1099','1100','1101','1102','1103','1104'],
      ['CG 5','(ABOVE TAPE RACK)CG 5 1105-1120','70','1105','1106','1107','1108','1109','1110','1111','1112','1113','1114','1115','1116','1117','1118','1119','1120'],
      ['CG 6','(ABOVE TAPE RACK)CG 6 1121-1136','71','1121','1122','1123','1124','1125','1126','1127','1128','1129','1130','1131','1132','1133','1134','1135','1136'],
      ['IN 072','NOT USED (DE-EMBED)','72'],
      ['CANVAS 1','CG CANVAS 1 1153-1168','73','1153','1154','1155','1156','1157','1158','1159','1160','1161','1162','1163','1164','1165','1166','1167','1168'],
      ['CANVAS 2','CG CANVAS 2 1169-1184','74','1169','1170','1171','1172','1173','1174','1175','1176','1177','1178','1179','1180','1181','1182','1183','1184'],
      ['DECODE1','Sat Decode 1 1185-1200','75','1185','1186','1187','1188','1189','1190','1191','1192','1193','1194','1195','1196','1197','1198','1199','1200'],
      ['DECODE2','Sat Decode 2 1201-1216','76','1201','1202','1203','1204','1205','1206','1207','1208','1209','1210','1211','1212','1213','1214','1215','1216'],
      ['TX1 DA','TX1 DA 1217-1232','77','1217','1218','1219','1220','1221','1222','1223','1224','1225','1226','1227','1228','1229','1230','1231','1232'],
      ['TX2 DA','TX2 DA 1233-1248','78','1233','1234','1235','1236','1237','1238','1239','1240','1241','1242','1243','1244','1245','1246','1247','1248'],
      ['PGM DA','PGM DA 1249-1264','79','1249','1250','1251','1252','1253','1254','1255','1256','1257','1258','1259','1260','1261','1262','1263','1264'],
      ['ISO DA','ISO DA 1265-1280','80','1265','1266','1267','1268','1269','1270','1271','1272','1273','1274','1275','1276','1277','1278','1279','1280'],
      ['IN 081','NOT USED (DE-EMBED)','81'],
      ['RET 1','Camera Return 1 1297-1312','82','1297','1298','1299','1300','1301','1302','1303','1304','1305','1306','1307','1308','1309','1310','1311','1312'],
      ['RET 2','Camera Return 2 1313-1328','83','1313','1314','1315','1316','1317','1318','1319','1320','1321','1322','1323','1324','1325','1326','1327','1328'],
      ['BARS','Evertz Bars/Tone 1329-1344','84','1329','1330','1331','1332','1333','1334','1335','1336','1337','1338','1339','1340','1341','1342','1343','1344'],
      ['BLACK','Evertz Black/Silence 1345-1360','85','1345','1346','1347','1348','1349','1350','1351','1352','1353','1354','1355','1356','1357','1358','1359','1360'],
      ['VALID','Hitomi Lip Sync 1361-1376','86','1361','1362','1363','1364','1365','1366','1367','1368','1369','1370','1371','1372','1373','1374','1375','1376'],
      ['DEM 87','De-Embedder 87 1377-1392','87','1377','1378','1379','1380','1381','1382','1383','1384','1385','1386','1387','1388','1389','1390','1391','1392'],
      ['DEM 88','De-Embedder 88 1393-1408','88','1393','1394','1395','1396','1397','1398','1399','1400','1401','1402','1403','1404','1405','1406','1407','1408'],
      ['TVU DISP','De-Embedder 89 1409-1424','89','1409','1410','1411','1412','1413','1414','1415','1416','1417','1418','1419','1420','1421','1422','1423','1424'],
      ['IN 090','NOT USED (DE-EMBED)','90'],
      ['EVS 1-As','EVS 1-1 Character Out','91','1441','1442','1443','1444','1445','1446','1447','1448','1449','1450','1451','1452','1453','1454','1455','1456'],
      ['EVS 1-Bs','EVS 1-2 Character Out','92','1457','1458','1459','1460','1461','1462','1463','1464','1465','1466','1467','1468','1469','1470','1471','1472'],
      ['EVS1-Ain','EVS 1-3 Character (E/E In 1)','93','1473','1474','1475','1476','1477','1478','1479','1480','1481','1482','1483','1484','1485','1486','1487','1488'],
      ['EVS1-Bin','EVS 1-4 Character (E/E In 2)','94','1489','1490','1491','1492','1493','1494','1495','1496','1497','1498','1499','1500','1501','1502','1503','1504'],
      ['EVS1-Cin','EVS 1-5 Character (E/E In 3)','95','1505','1506','1507','1508','1509','1510','1511','1512','1513','1514','1515','1516','1517','1518','1519','1520'],
      ['EVS1-Din','EVS 1-6 Character (E/E In 4)','96','1521','1522','1523','1524','1525','1526','1527','1528','1529','1530','1531','1532','1533','1534','1535','1536'],
      ['EVS 1 MV','EVS 1 Multiviewer','97','1537','1538','1539','1540','1541','1542','1543','1544','1545','1546','1547','1548','1549','1550','1551','1552'],
      ['EVS 2-As','EVS 2-1 Character Out','98','1553','1554','1555','1556','1557','1558','1559','1560','1561','1562','1563','1564','1565','1566','1567','1568'],
      ['MADI 1','MADI Input 1 - 1441-1504','99'],
      ['EVS 2-Bs','EVS 2-2 Character Out','100','1585','1586','1587','1588','1589','1590','1591','1592','1593','1594','1595','1596','1597','1598','1599','1600'],
      ['EVS2-Ain','EVS 2-3 Character (E/E In 1)','101','1601','1602','1603','1604','1605','1606','1607','1608','1609','1610','1611','1612','1613','1614','1615','1616'],
      ['EVS2-Bin','EVS 2-4 Character (E/E In 2)','102','1617','1618','1619','1620','1621','1622','1623','1624','1625','1626','1627','1628','1629','1630','1631','1632'],
      ['EVS2-Cin','EVS 2-5 Character (E/E In 3)','103','1633','1634','1635','1636','1637','1638','1639','1640','1641','1642','1643','1644','1645','1646','1647','1648'],
      ['EVS2-Din','EVS 2-6 Character (E/E In 4)','104','1649','1650','1651','1652','1653','1654','1655','1656','1657','1658','1659','1660','1661','1662','1663','1664'],
      ['EVS 2 MV','EVS 2 Multiviewer','105','1665','1666','1667','1668','1669','1670','1671','1672','1673','1674','1675','1676','1677','1678','1679','1680'],
      ['EVS 3-As','EVS 3-1 Character Out','106','1681','1682','1683','1684','1685','1686','1687','1688','1689','1690','1691','1692','1693','1694','1695','1696'],
      ['EVS 3-Bs','EVS 3-2 Character Out','107','1697','1698','1699','1700','1701','1702','1703','1704','1705','1706','1707','1708','1709','1710','1711','1712'],
      ['MADI 2','MADI Input 2 - 1585-1648','108'],
      ['EVS3-Ain','EVS 3-3 Character (E/E In 1)','109','1729','1730','1731','1732','1733','1734','1735','1736','1737','1738','1739','1740','1741','1742','1743','1744'],
      ['EVS3-Bin','EVS 3-4 Character (E/E In 2)','110','1745','1746','1747','1748','1749','1750','1751','1752','1753','1754','1755','1756','1757','1758','1759','1760'],
      ['EVS3-Cin','EVS 3-5 Character (E/E In 3)','111','1761','1762','1763','1764','1765','1766','1767','1768','1769','1770','1771','1772','1773','1774','1775','1776'],
      ['EVS3-Din','EVS 3-6 Character (E/E In 4)','112','1777','1778','1779','1780','1781','1782','1783','1784','1785','1786','1787','1788','1789','1790','1791','1792'],
      ['EVS 3 MV','EVS 3 Multiviewer','113','1793','1794','1795','1796','1797','1798','1799','1800','1801','1802','1803','1804','1805','1806','1807','1808'],
      ['EVS 4-1s','EVS 4-1 Character Out','114','1809','1810','1811','1812','1813','1814','1815','1816','1817','1818','1819','1820','1821','1822','1823','1824'],
      ['EVS 4-2s','EVS 4-2 Character Out','115','1825','1826','1827','1828','1829','1830','1831','1832','1833','1834','1835','1836','1837','1838','1839','1840'],
      ['EVS1-5in','EVS 4-3 Character (E/E In 1)','116','1841','1842','1843','1844','1845','1846','1847','1848','1849','1850','1851','1852','1853','1854','1855','1856'],
      ['MADI 3','MADI Input 3 - 1729-1792','117'],
      ['EVS1-6in','EVS 4-4 Character (E/E In 2)','118','1873','1874','1875','1876','1877','1878','1879','1880','1881','1882','1883','1884','1885','1886','1887','1888'],
      ['EVS2-5in','EVS 4-5 Character (E/E In 3)','119','1889','1890','1891','1892','1893','1894','1895','1896','1897','1898','1899','1900','1901','1902','1903','1904'],
      ['EVS2-6in','EVS 4-6 Character (E/E In 4)','120','1905','1906','1907','1908','1909','1910','1911','1912','1913','1914','1915','1916','1917','1918','1919','1920'],
      ['IN 121','EVS 4 Multiviewer','121','1921','1922','1923','1924','1925','1926','1927','1928','1929','1930','1931','1932','1933','1934','1935','1936'],
      ['TVU DISP','EVS 5-1 Character Out','122','1937','1938','1939','1940','1941','1942','1943','1944','1945','1946','1947','1948','1949','1950','1951','1952'],
      ['FS 25','EVS 5-2 Character Out','123','1953','1954','1955','1956','1957','1958','1959','1960','1961','1962','1963','1964','1965','1966','1967','1968'],
      ['FS 26','EVS 5-3 Character (E/E In 1)','124','1969','1970','1971','1972','1973','1974','1975','1976','1977','1978','1979','1980','1981','1982','1983','1984'],
      ['FS 27','EVS 5-4 Character (E/E In 2)','125','1985','1986','1987','1988','1989','1990','1991','1992','1993','1994','1995','1996','1997','1998','1999','2000'],
      ['MADI 4','MADI Input 4 - 1873-1936','126'],
      ['FS 28','EVS 5-5 Character (E/E In 3)','127','2017','2018','2019','2020','2021','2022','2023','2024','2025','2026','2027','2028','2029','2030','2031','2032'],
      ['FS 29','EVS 5-6 Character (E/E In 4)','128','2033','2034','2035','2036','2037','2038','2039','2040','2041','2042','2043','2044','2045','2046','2047','2048'],
      ['FS 30','EVS 5 Multiviewer','129','2049','2050','2051','2052','2053','2054','2055','2056','2057','2058','2059','2060','2061','2062','2063','2064'],
      ['MV 25-1','DE-EMBED IN 130 (2065-2080)','130','2065','2066','2067','2068','2069','2070','2071','2072','2073','2074','2075','2076','2077','2078','2079','2080'],
      ['MV 26-1','DE-EMBED IN 131 (2081-2096)','131','2081','2082','2083','2084','2085','2086','2087','2088','2089','2090','2091','2092','2093','2094','2095','2096'],
      ['MV 26-2','DE-EMBED IN 132 (2097-2112)','132','2097','2098','2099','2100','2101','2102','2103','2104','2105','2106','2107','2108','2109','2110','2111','2112'],
      ['MV 26-3','DE-EMBED IN 133 (2113-2128)','133','2113','2114','2115','2116','2117','2118','2119','2120','2121','2122','2123','2124','2125','2126','2127','2128'],
      ['M 26-4','DE-EMBED IN 134 (2129-2144)','134','2129','2130','2131','2132','2133','2134','2135','2136','2137','2138','2139','2140','2141','2142','2143','2144'],
      ['MADI 5','MADI Input 5 - 2017-2080','135'],
      ['DEM 136','Patched to VTR 1 Character','136'],
      ['MV 25-2','VTR 2 Character','137'],
      ['XFile 3','XFile3 Canvas HDMI>SDI','138'],
      ['PGM A','Kayenne Output 1','139','2209','2210','2211','2212','2213','2214','2215','2216','2217','2218','2219','2220','2221','2222','2223','2224'],
      ['CLEAN','Kayenne Output 2','140','1477','1478','1479','1480','2229','2230','2231','2232','2233','2234','2235','2236','2237','2238','2239','2240'],
      ['PRESET','Kayenne Output 3','141','1473','1474','1475','1476','2245','2246','2247','2248','2249','2250','2251','2252','2253','2254','2255','2256'],
      ['SWR PVW','Kayenne Output 4','142','1473','1474','1475','1476','2261','2262','2263','2264','2265','2266','2267','2268','2269','2270','2271','2272'],
      ['ME1 PVW','Kayenne Output 5','143','1473','1474','1475','1476','2277','2278','2279','2280','2281','2282','2283','2284','2285','2286','2287','2288'],
      ['MADI 6','MADI Input 6 - 2161-2224','144','1473','1474','1475','1476','2293','2294','2295','2296','2297','2298','2299','2300','2301','2302','2303','2304'],
      ['ME1 A','Kayenne Output 6','145','1473','1474','1475','1476','2309','2310','2311','2312','2313','2314','2315','2316','2317','2318','2319','2320'],
      ['ME1 B','Kayenne Output 7','146','1473','1474','1475','1476','2325','2326','2327','2328','2329','2330','2331','2332','2333','2334','2335','2336'],
      ['ME1 C','Kayenne Output 8','147','1473','1474','1475','1476','2341','2342','2343','2344','2345','2346','2347','2348','2349','2350','2351','2352'],
      ['ME1 D','Kayenne Output 9','148','1473','1474','1475','1476','2357','2358','2359','2360','2361','2362','2363','2364','2365','2366','2367','2368'],
      ['ME2 PVW','Kayenne Output 10','149','1473','1474','1475','1476','2373','2374','2375','2376','2377','2378','2379','2380','2381','2382','2383','2384'],
      ['ME2 A','Kayenne Output 11','150','1473','1474','1475','1476','2389','2390','2391','2392','2393','2394','2395','2396','2397','2398','2399','2400'],
      ['ME2 B','Kayenne Output 12','151','1473','1474','1475','1476','2405','2406','2407','2408','2409','2410','2411','2412','2413','2414','2415','2416'],
      ['ME2 C','Kayenne Output 13','152','1473','1474','1475','1476','2421','2422','2423','2424','2425','2426','2427','2428','2429','2430','2431','2432'],
      ['ME2 D','Kayenne Output 14','153','1473','1474','1475','1476','2437','2438','2439','2440','2441','2442','2443','2444','2445','2446','2447','2448'],
      ['ME3 PVW','Kayenne Output 15','154','1473','1474','1475','1476','2453','2454','2455','2456','2457','2458','2459','2460','2461','2462','2463','2464'],
      ['ME3 A','Kayenne Output 16','155','1473','1474','1475','1476','2469','2470','2471','2472','2473','2474','2475','2476','2477','2478','2479','2480'],
      ['ME3 B','Kayenne Output 17','156','1473','1474','1475','1476','2485','2486','2487','2488','2489','2490','2491','2492','2493','2494','2495','2496'],
      ['ME3 C','Kayenne Output 18','157','1473','1474','1475','1476','2501','2502','2503','2504','2505','2506','2507','2508','2509','2510','2511','2512'],
      ['ME3 D','Kayenne Output 19','158','1473','1474','1475','1476','2517','2518','2519','2520','2521','2522','2523','2524','2525','2526','2527','2528'],
      ['ME4 PVW','Kayenne Output 20','159','1473','1474','1475','1476','2533','2534','2535','2536','2537','2538','2539','2540','2541','2542','2543','2544'],
      ['ME4 A','Kayenne Output 21','160','1473','1474','1475','1476','2549','2550','2551','2552','2553','2554','2555','2556','2557','2558','2559','2560'],
      ['ME4 B','Kayenne Output 22','161','1477','1478','1479','1480','2565','2566','2567','2568','2569','2570','2571','2572','2573','2574','2575','2576'],
      ['ME4 C','Kayenne Output 23','162','1477','1478','1479','1480','2581','2582','2583','2584','2585','2586','2587','2588','2589','2590','2591','2592'],
      ['ME4 D','Kayenne Output 24','163','1477','1478','1479','1480','1445','1446','1447','1448','1449','1450','1451','1452','1453','1454','1455','1456'],
      ['AUX 01','Kayenne Output 25','164','1477','1478','1479','1480','2613','2614','2615','2616','2617','2618','2619','2620','2621','2622','2623','2624'],
      ['AUX 02','Kayenne Output 26','165','1477','1478','1479','1480','2629','2630','2631','2632','2633','2634','2635','2636','2637','2638','2639','2640'],
      ['AUX 03','Kayenne Output 27','166','1477','1478','1479','1480','2629','2630','2631','2632','2633','2634','2635','2636','2637','2638','2639','2640'],
      ['AUX 04','Kayenne Output 28','167','1477','1478','1479','1480','2661','2662','2663','2664','2665','2666','2667','2668','2669','2670','2671','2672'],
      ['AUX 05','Kayenne Output 29','168','1477','1478','1479','1480','2677','2678','2679','2680','2681','2682','2683','2684','2685','2686','2687','2688'],
      ['AUX 06','Kayenne Output 30','169','1477','1478','1479','1480','2693','2694','2695','2696','2697','2698','2699','2700','2701','2702','2703','2704'],
      ['AUX 07','Kayenne Output 31','170','1477','1478','1479','1480','2709','2710','2711','2712','2713','2714','2715','2716','2717','2718','2719','2720'],
      ['AUX 08','Kayenne Output 32','171','1477','1478','1479','1480','2725','2726','2727','2728','2729','2730','2731','2732','2733','2734','2735','2736'],
      ['AUX 09','Kayenne Output 33','172','1477','1478','1479','1480','2741','2742','2743','2744','2745','2746','2747','2748','2749','2750','2751','2752'],
      ['AUX 10','Kayenne Output 34','173','1477','1478','1479','1480','2757','2758','2759','2760','2761','2762','2763','2764','2765','2766','2767','2768'],
      ['AUX 11','Kayenne Output 35','174','1477','1478','1479','1480','2773','2774','2775','2776','2777','2778','2779','2780','2781','2782','2783','2784'],
      ['AUX 12','Kayenne Output 36','175','1477','1478','1479','1480','2789','2790','2791','2792','2793','2794','2795','2796','2797','2798','2799','2800'],
      ['IS 01','Kayenne Output 37','176','1477','1478','1479','1480','2805','2806','2807','2808','2809','2810','2811','2812','2813','2814','2815','2816'],
      ['IS 02','Kayenne Output 38','177','1477','1478','1479','1480','2821','2822','2823','2824','2825','2826','2827','2828','2829','2830','2831','2832'],
      ['IS 03','Kayenne Output 39','178','1477','1478','1479','1480','2837','2838','2839','2840','2841','2842','2843','2844','2845','2846','2847','2848'],
      ['IS 04','Kayenne Output 40','179','1329','1330','1331','1332','1333','1334','1335','1336','1337','1338','1339','1340','1341','1342','1343','1344'],
      ['IS 05','Kayenne Output 41','180','1329','1330','1331','1332','1333','1334','1335','1336','1337','1338','1339','1340','1341','1342','1343','1344'],
      ['IS 06','Kayenne Output 42','181','1329','1330','1331','1332','1333','1334','1335','1336','1337','1338','1339','1340','1341','1342','1343','1344'],
      ['IS 07','Kayenne Output 43','182','1329','1330','1331','1332','1333','1334','1335','1336','1337','1338','1339','1340','1341','1342','1343','1344'],
      ['IS 08','Kayenne Output 44','183','1329','1330','1331','1332','1333','1334','1335','1336','1337','1338','1339','1340','1341','1342','1343','1344'],
      ['IS 09','Kayenne Output 45','184','1329','1330','1331','1332','1333','1334','1335','1336','1337','1338','1339','1340','1341','1342','1343','1344'],
      ['IS 10','Kayenne Output 46','185','1329','1330','1331','1332','1333','1334','1335','1336','1337','1338','1339','1340','1341','1342','1343','1344'],
      ['CPIX 01','CCU PIX/Character Out 1','186'],['CPIX 02','CCU PIX/Character Out 2','187'],['CPIX 03','CCU PIX/Character Out 3','188'],['CPIX 04','CCU PIX/Character Out 4','189'],['CPIX 05','CCU PIX/Character Out 5','190'],['CPIX 06','CCU PIX/Character Out 6','191'],
      ['CPIX 07','CCU PIX/Character Out 7','192'],['CPIX 08','CCU PIX/Character Out 8','193'],['CPIX 09','CCU PIX/Character Out 9','194'],['CPIX 10','CCU PIX/Character Out 10','195'],['CPIX 11','CCU PIX/Character Out 11','196'],['CPIX 12','CCU PIX/Character Out 12','197'],
      ['MV 1-1','Multiviewer Head 1-1','198'],['MV 1-2','Multiviewer Head 1-2','199'],['MV 2-1','Multiviewer Head 2-1','200'],['MV 2-2','Multiviewer Head 2-2','201'],
      ['MV 3-1','Multiviewer Head 3-1','202'],['MV 3-2','Multiviewer Head 3-2','203'],['MV 4-1','Multiviewer Head 4-1','204'],['MV 4-2','Multiviewer Head 4-2','205'],
      ['MV 5-1','Multiviewer Head 5-1','206'],['MV 5-2','Multiviewer Head 5-2','207'],['MV 6-1','Multiviewer Head 6-1','208'],['MV 6-2','Multiviewer Head 6-2','209'],
      ['MV 7-1','Multiviewer Head 7-1','210'],['MV 7-2','Multiviewer Head 7-2','211'],['MV 8-1','Multiviewer Head 8-1','212'],['MV 8-2','Multiviewer Head 8-2','213'],
      ['MV 9-1','Multiviewer Head 9-1','214'],['MV 9-2','Multiviewer Head 9-2','215'],['MV 10-1','Multiviewer Head 10-1','216'],['MV 10-2','Multiviewer Head 10-2','217'],
      ['MV 11-1','Multiviewer Head 11-1','218'],['MV 11-2','Multiviewer Head 11-2','219'],['MV 12-1','Multiviewer Head 12-1','220'],['MV 12-2','Multiviewer Head 12-2','221'],
      ['MV 13-1','Multiviewer Head 13-1','222'],['MV 13-2','Multiviewer Head 13-2','223'],['MV 14-1','Multiviewer Head 14-1','224'],['MV 14-2','Multiviewer Head 14-2','225'],
      ['MV 15-1','Multiviewer Head 15-1','226'],['MV 15-2','Multiviewer Head 15-2','227'],['MV 16-1','Multiviewer Head 16-1','228'],['MV 16-2','Multiviewer Head 16-2','229'],
      ['MV 17-1','Multiviewer Head 17-1','230'],['MV 17-2','Multiviewer Head 17-2','231'],['MV 18-1','Multiviewer Head 18-1','232'],['MV 18-2','Multiviewer Head 18-2','233'],
      ['MV 19-1','Multiviewer Head 19-1','234'],['MV 19-2','Multiviewer Head 19-2','235'],['MV 20-1','Multiviewer Head 20-1','236'],['MV 20-2','Multiviewer Head 20-2','237'],
      ['MV 21-1','Multiviewer Head 21-1','238'],['MV 21-2','Multiviewer Head 21-2','239'],['MV 22-1','Multiviewer Head 22-1','240'],['MV 22-2','Multiviewer Head 22-2','241'],
      ['MV 23-1','Multiviewer Head 23-1','242'],['MV 23-2','Multiviewer Head 23-2','243'],
      ['MV 24-1','Multiviewer Head 24-1','244','4033'],['MV 24-2','Multiviewer Head 24-2','245','4049'],
      ['CANVAS 3','Spare Input 246(ABOVE TAPE RACK)','246','4065'],['CANVAS 4','Spare Input 247(ABOVE TAPE RACK)','247','4081'],
      ['CANVAS 5','Spare Input 248(ABOVE TAPE RACK)','248','4097'],['CANVAS 6','Spare Input 249(ABOVE TAPE RACK)','249','4113'],
      ['CANVAS 7','Spare Input 250(ABOVE TAPE RACK)','250','4129'],['CANVAS 8','Spare Input 251(ABOVE TAPE RACK)','251','4145'],
      ['IN 252','Spare Input 252','252'],
      ['FS 31','Neuron Output 1','253','4033','4034','4035','4036','4037','4038','4039','4040','4041','4042','4043','4044','4045','4046','4047','4048'],
      ['FS 32','Neuron Output 2','254','4049','4050','4051','4052','4053','4054','4055','4056','4057','4058','4059','4060','4061','4062','4063','4064'],
      ['FS 33','Neuron Output 3','255','4065','4066','4067','4068','4069','4070','4071','4072','4073','4074','4075','4076','4077','4078','4079','4080'],
      ['FS 34','Neuron Output 4','256','4081','4082','4083','4084','4085','4086','4087','4088','4089','4090','4091','4092','4093','4094','4095','4096'],
      ['FS 35','Neuron Output 5','257','4097','4098','4099','4100','4101','4102','4103','4104','4105','4106','4107','4108','4109','4110','4111','4112'],
      ['FS 36','Neuron Output 6','258','4113','4114','4115','4116','4117','4118','4119','4120','4121','4122','4123','4124','4125','4126','4127','4128'],
      ['FS 37','Neuron Output 7','259','4129','4130','4131','4132','4133','4134','4135','4136','4137','4138','4139','4140','4141','4142','4143','4144'],
      ['FS 38','Neuron Output 8','260','4145','4146','4147','4148','4149','4150','4151','4152','4153','4154','4155','4156','4157','4158','4159','4160'],
      ['FUT261','FUTURE INPUT (NO CARD)','261','4161','4162','4163','4164','4165','4166','4167','4168','4169','4170','4171','4172','4173','4174','4175','4176'],
      ['FS 39','Neuron Output 9','262','4177','4178','4179','4180','4181','4182','4183','4184','4185','4186','4187','4188','4189','4190','4191','4192'],
      ['FS 40','Neuron Output 10','263','4193','4194','4195','4196','4197','4198','4199','4200','4201','4202','4203','4204','4205','4206','4207','4208'],
      ['FS 41','Neuron Output 11','264','4209','4210','4211','4212','4213','4214','4215','4216','4217','4218','4219','4220','4221','4222','4223','4224'],
      ['FS 42','Neuron Output 12','265','4225','4226','4227','4228','4229','4230','4231','4232','4233','4234','4235','4236','4237','4238','4239','4240'],
      ['FS 43','Neuron Output 13','266','4241','4242','4243','4244','4245','4246','4247','4248','4249','4250','4251','4252','4253','4254','4255','4256'],
      ['FS 44','Neuron Output 14','267','4257','4258','4259','4260','4261','4262','4263','4264','4265','4266','4267','4268','4269','4270','4271','4272'],
      ['FS 45','Neuron Output 15','268','4273','4274','4275','4276','4277','4278','4279','4280','4281','4282','4283','4284','4285','4286','4287','4288'],
      ['FS 46','Neuron Output 16','269','4289','4290','4291','4292','4293','4294','4295','4296','4297','4298','4299','4300','4301','4302','4303','4304'],
      ['FUT270','FUTURE INPUT (NO CARD)','270'],
      ['FS 47','Neuron Output 17','271','4321','4322','4323','4324','4325','4326','4327','4328','4329','4330','4331','4332','4333','4334','4335','4336'],
      ['FS 48','Neuron Output 18','272','4337','4338','4339','4340','4341','4342','4343','4344','4345','4346','4347','4348','4349','4350','4351','4352'],
      ['FS 49','Neuron Output 19','273','4353','4354','4355','4356','4357','4358','4359','4360','4361','4362','4363','4364','4365','4366','4367','4368'],
      ['FS 50','Neuron Output 20','274','4369','4370','4371','4372','4373','4374','4375','4376','4377','4378','4379','4380','4381','4382','4383','4384'],
      ['FS 51','Neuron Output 21','275','4385','4386','4387','4388','4389','4390','4391','4392','4393','4394','4395','4396','4397','4398','4399','4400'],
      ['FS 52','Neuron Output 22','276','4401','4402','4403','4404','4405','4406','4407','4408','4409','4410','4411','4412','4413','4414','4415','4416'],
      ['FS 53','Neuron Output 23','277','4417','4418','4419','4420','4421','4422','4423','4424','4425','4426','4427','4428','4429','4430','4431','4432'],
      ['FS 54','Neuron Output 24','278','4433','4434','4435','4436','4437','4438','4439','4440','4441','4442','4443','4444','4445','4446','4447','4448'],
      ['FUT279','FUTURE INPUT (NO CARD)','279'],
      ['FS 55','Neuron Output 25','280','4465','4466','4467','4468','4469','4470','4471','4472','4473','4474','4475','4476','4477','4478','4479','4480'],
      ['FS 56','Neuron Output 26','281','4481','4482','4483','4484','4485','4486','4487','4488','4489','4490','4491','4492','4493','4494','4495','4496'],
      ['FS 57','Neuron Output 27','282','4497','4498','4499','4500','4501','4502','4503','4504','4505','4506','4507','4508','4509','4510','4511','4512'],
      ['FS 58','Neuron Output 28','283','4513','4514','4515','4516','4517','4518','4519','4520','4521','4522','4523','4524','4525','4526','4527','4528'],
      ['FS 59','Neuron Output 29','284','4529','4530','4531','4532','4533','4534','4535','4536','4537','4538','4539','4540','4541','4542','4543','4544'],
      ['FS 60','Neuron Output 30','285','4545','4545','4545','4545','4545','4545','4545','4545','4545','4545','4545','4545','4545','4545','4545','4545'],
      ['FS 61','Neuron Output 31','286','4561','4562','4563','4564','4565','4566','4567','4568','4569','4570','4571','4572','4573','4574','4575','4576'],
      ['FS 62','Neuron Output 32','287','4577','4578','4579','4580','4581','4582','4583','4584','4585','4586','4587','4588','4589','4590','4591','4592'],
      ['FUT288','FUTURE INPUT (NO CARD)',''],
      // ── Extended devices (SHOW sources, ISOs, REMIs, audio-only, etc.) ──
      ['SHOW01','Show cam with under cam audio','',''],
      ['SHOW02','Show cam with under cam audio','',''],
      ['SHOW03','Show cam with under cam audio','',''],
      ['SHOW04','Show cam with under cam audio','',''],
      ['SHOW05','Show cam with under cam audio','',''],
      ['SHOW06','Show cam with under cam audio','',''],
      ['SHOW07','Show cam with under cam audio','',''],
      ['SHOW08','Show cam with under cam audio','',''],
      ['SHOW09','Show cam with under cam audio','',''],
      ['SHOW10','Show cam with under cam audio','',''],
      ['SHOW11','Show cam with under cam audio','',''],
      ['SHOW12','Show cam with under cam audio','',''],
      ['SHOW13','Show cam with under cam audio','',''],
      ['SHOW14','Show cam with under cam audio','',''],
      ['SHOW15','Show cam with under cam audio','',''],
      ['SHOW16','Show cam with under cam audio','',''],
      ['SHOW17','Show cam with under cam audio','',''],
      ['SHOW18','Show cam with under cam audio','',''],
      ['SHOW19','Show cam with under cam audio','',''],
      ['SHOW20','Show cam with under cam audio','',''],
      ['C01 ISO','CAM 1 ISO FROM CALREC','1','1481','1482','1477','1478'],
      ['C02 ISO','CAM 2 ISO FROM CALREC','2','1483','1484','1477','1478'],
      ['C03 ISO','CAM 3 ISO FROM CALREC','3','1485','1486','1477','1478'],
      ['C04 ISO','CAM 4 ISO FROM CALREC','4','1487','1488','1477','1478'],
      ['C05 ISO','CAM 5 ISO FROM CALREC','5','1489','1490','1477','1478'],
      ['C06 ISO','CAM 6 ISO FROM CALREC','6','1491','1492','1477','1478'],
      ['C07 ISO','CAM 7 ISO FROM CALREC','7','1493','1494','1477','1478'],
      ['C08 ISO','CAM 8 ISO FROM CALREC','8','1495','1496','1477','1478'],
      ['C09 ISO','CAM 9 ISO FROM CALREC','14','1497','1498','1477','1478'],
      ['C10 ISO','CAM 10 ISO FROM CALREC','15','1499','1500','1477','1478'],
      ['C11 ISO','CAM 11 ISO FROM CALREC','12','1501','1502','1477','1478'],
      ['C12 ISO','CAM 12 ISO FROM CALREC','13','1503','1504','1477','1478'],
      ['*iso01','AUDIO ISO 1','','1585','1586','1587','1588'],
      ['*iso02','AUDIO ISO 2','','1589','1590','1591','1592'],
      ['*iso03','AUDIO ISO 3','','1593','1594','1595','1596'],
      ['*iso04','AUDIO ISO 4','','1597','1598','1599','1600'],
      ['*iso05','AUDIO ISO 5','','1601','1602','1603','1604'],
      ['*iso06','AUDIO ISO 6','','1605','1606','1607','1608'],
      ['*iso07','AUDIO ISO 7','','1609','1610','1611','1612'],
      ['*iso08','AUDIO ISO 8','','1613','1614','1615','1616'],
      ['*iso09','AUDIO ISO 9','','1617','1618','1619','1620'],
      ['*iso10','AUDIO ISO 10','','1621','1622','1623','1624'],
      ['*iso11','AUDIO ISO 11','','1625','1626','1627','1628'],
      ['*iso12','AUDIO ISO 12','','1629','1630','1631','1632'],
      ['*obtw 1','OBTW ISO 1','','1633','1634','1635','1636'],
      ['*obtw 2','OBTW ISO 2','','1637','1638','1639','1640'],
      ['PGM','Truck PGM (PGMA + CNSL PGM)','139','1473','1474','1475','1476','1349','1350','1351','1352','1353','1354','1355','1356','1357','1358','1359','1360'],
      ['TX1 PGM','TX1 Normal (PGMA + CNSL TX1)','139','1441','1442','1443','1444','1445','1446','1447','1448','1449','1450','1451','1452','1453','1454','1455','1456'],
      ['TX2 PGM','TX2 Normal (PGMB + CNSL TX2)','175','1457','1458','1459','1460','1461','1462','1463','1464','1465','1466','1467','1468','1469','1470','1471','1472'],
      ['VRT 1','Virtual Re-Entry 1','289','4609','4610','4611','4612','4613','4614','4615','4616','4617','4618','4619','4620','4621','4622','4623','4624'],
      ['VRT 2','Virtual Re-Entry 2','290','4625','4626','4627','4628','4629','4630','4631','4632','4633','4634','4635','4636','4637','4638','4639','4640'],
      ['VRT 3','Virtual Re-Entry 3','291','4641','4642','4643','4644','4645','4646','4647','4648','4649','4650','4651','4652','4653','4654','4655','4656'],
      ['VRT 4','Virtual Re-Entry 4','292','4657','4658','4659','4660','4661','4662','4663','4664','4665','4666','4667','4668','4669','4670','4671','4672'],
      ['VRT 5','Virtual Re-Entry 5','293','4673','4674','4675','4676','4677','4678','4679','4680','4681','4682','4683','4684','4685','4686','4687','4688'],
      ['VRT 6','Virtual Re-Entry 6','294','4689','4690','4691','4692','4693','4694','4695','4696','4697','4698','4699','4700','4701','4702','4703','4704'],
      ['SHOW21','Show cam with under cam audio','',''],
      ['SHOW22','Show cam with under cam audio','',''],
      ['SHOW23','Show cam with under cam audio','',''],
      ['SHOW24','Show cam with under cam audio','',''],
      ['SHOW25','Show cam with under cam audio','',''],
      ['SHOW26','Show cam with under cam audio','',''],
      ['SHOW27','Show cam with under cam audio','',''],
      ['SHOW28','Show cam with under cam audio','',''],
      ['SHOW29','Show cam with under cam audio','',''],
      ['SHOW30','Show cam with under cam audio','',''],
      ['SHOW31','Show cam with under cam audio','',''],
      ['SHOW32','Show cam with under cam audio','',''],
      ['SHOW33','Show cam with under cam audio','',''],
      ['SHOW34','Show cam with under cam audio','',''],
      ['SHOW35','Show cam with under cam audio','',''],
      ['SHOW36','Show cam with under cam audio','',''],
      ['SHOW37','Show cam with under cam audio','',''],
      ['SHOW38','Show cam with under cam audio','',''],
      ['SHOW39','Show cam with under cam audio','',''],
      ['SHOW40','Show cam with under cam audio','',''],
      ['REMI 01','REMI 1 with Calrec MOD 1 Madi','','1729','1730','1731','1732','1733','1734','1735','1736'],
      ['REMI 02','REMI 2 with Calrec MOD 1 Madi','','1737','1738','1739','1740','1741','1742','1743','1744'],
      ['REMI 03','REMI 3 with Calrec MOD 1 Madi','','1745','1746','1747','1748','1749','1750','1751','1752'],
      ['REMI 04','REMI 4 with Calrec MOD 1 Madi','','1753','1754','1755','1756','1757','1758','1759','1760'],
      ['REMI 05','REMI 5 with Calrec MOD 1 Madi','','1761','1762','1763','1764','1765','1766','1767','1768'],
      ['REMI 06','REMI 6 with Calrec MOD 1 Madi','','1769','1770','1771','1772','1773','1774','1775','1776'],
      ['REMI 07','REMI 7 with Calrec MOD 1 Madi','','1777','1778','1779','1780','1781','1782','1783','1784'],
      ['REMI 08','REMI 8 with Calrec MOD 1 Madi','','1785','1786','1787','1788','1789','1790','1791','1792'],
      ['REMI 09','REMI 9 with Calrec MOD 1 Madi','','1873','1874','1875','1876','1877','1878','1879','1880'],
      ['REMI 10','REMI 10 with Calrec MOD 1 Madi','','1881','1882','1883','1884','1885','1886','1887','1888'],
      ['REMI 11','REMI 11 WITH REMI 10 AUDIO','','1889','1890','1891','1892','1893','1894','1895','1896'],
      ['REMI 12','','','1897','1898','1899','1900','1901','1902','1903','1904'],
      ['*CNSLCAM','','','1477','1478','1479','1480'],
      ['*CNSLPGM','','','1473','1474','1475','1476'],
      ['*GAME FX','','','1591','1592','1591','1592'],
      ['*GAMEPGM','','','1589','1590','1589','1590'],
      ['CNSL TX1','','','1441','1442','1443','1444','1445','1446','1447','1448','1449','1450','1451','1452','1453','1454','1455','1456'],
      ['CNSL TX2','','','1457','1458','1459','1460','1461','1462','1463','1464','1465','1466','1467','1468','1469','1470','1471','1472'],
      ['*iso1&2','','','1585','1586','1587','1588','1589','1590','1591','1592'],
      ['*iso3&4','','','1593','1594','1595','1596','1597','1598','1599','1600'],
      ['*iso5&6','','','1601','1602','1603','1604','1605','1606','1607','1608'],
      ['*iso7&8','','','1609','1610','1611','1612','1613','1614','1615','1616'],
      ['*iso9&10','','','1617','1618','1619','1620','1621','1622','1623','1624'],
      ['*iso11&12','','','1625','1626','1627','1628','1629','1630','1631','1632'],
    ];
    // Convert compact data to full device objects
    const devices = _D.map((d, i) => {
      const audio = Array(16).fill('');
      for (let a = 0; a < 16 && a + 3 < d.length; a++) {
        audio[a] = d[a + 3] || '';
      }
      return { row: i + 1, deviceName: d[0] || '', deviceDesc: d[1] || '', videoLevel: d[2] || '', audio };
    });
    // Pad with empty rows to 470 total
    while (devices.length < 470) {
      devices.push({ row: devices.length + 1, deviceName: '', deviceDesc: '', videoLevel: '', audio: Array(16).fill('') });
    }
    return devices;
  }

  // ── MU-21 Router OUTPUTS — Default device library ──
  // Exact data from the RTR I/O MASTER SHEET Google Sheet (columns V-AO).
  // Format: [deviceName, deviceDesc, videoLevel, audio1..audio12]
  // Audio channels 13-16 padded as empty (sheet only populates 12 embed channels per output).
  function defaultRtrOutputs() {
    const _D = [
      ['EVS 1-1','EVS 1-1 In (1-16)','1','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16'],
      ['EVS 1-2','EVS 1-2 In (17-32)','2','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32'],
      ['EVS 1-3','EVS 1-3 In (33-48)','3','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48'],
      ['EVS 1-4','EVS 1-4 In (49-64)','4','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64'],
      ['EVS 2-1','EVS 2-1 In (65-80)','5','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80'],
      ['EVS 2-2','EVS 2-2 In (81-96)','6','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96'],
      ['EVS 2-3','EVS 2-3 In (97-112)','7','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112'],
      ['EVS 2-4','EVS 2-4 In (113-128)','8','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128'],
      ['Out 009','NOT USED (EMBED)','9'],
      ['EVS 3-1','EVS 3-1 In (145-160)','10','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160'],
      ['EVS 3-2','EVS 3-2 In (161-176)','11','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176'],
      ['EVS 3-3','EVS 3-3 In (177-192)','12','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192'],
      ['EVS 3-4','EVS 3-4 In (193-208)','13','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208'],
      ['EVS 1-5','EVS 4-1 IN (209-224)','14','209','210','211','212','213','214','215','216','217','218','219','220','221','222','223','224'],
      ['EVS 1-6','EVS 4-2 in (225-240)','15','225','226','227','228','229','230','231','232','233','234','235','236','237','238','239','240'],
      ['EVS 2-5','EVS 4-3 IN (241-256)','16','241','242','243','244','245','246','247','248','249','250','251','252','253','254','255','256'],
      ['EVS 2-6','EVS 4-4 IN (257-272)','17','257','258','259','260','261','262','263','264','265','266','267','268','269','270','271','272'],
      ['Out 018','NOT USED (EMBED)','18'],
      ['EVS 5-1','EVS 5-1 IN (289-304)','19','289','290','291','292','293','294','295','296','297','298','299','300','301','302','303','304'],
      ['EVS 5-2','EVS 5-2 IN (305-320)','20','305','306','307','308','309','310','311','312','313','314','315','316','317','318','319','320'],
      ['EVS 5-3','EVS 5-3 IN (321-336)','21','321','322','323','324','325','326','327','328','329','330','331','332','333','334','335','336'],
      ['EVS 5-4','EVS 5-4 IN (337-352)','22','337','338','339','340','341','342','343','344','345','346','347','348','349','350','351','352'],
      ['VT 1','VTR 1 In (353-368)','23','353','354','355','356','357','358','359','360','361','362','363','364','365','366','367','368'],
      ['VT 2','VTR 2 In (369-384)','24','369','370','371','372','373','374','375','376','377','378','379','380','381','382','383','384'],
      ['VT 3','VTR 3 In (385-400)','25','385','386','387','388','389','390','391','392','393','394','395','396','397','398','399','400'],
      ['VT 4','VTR 4 In (401-416)','26','401','402','403','404','405','406','407','408','409','410','411','412','413','414','415','416'],
      ['Out 027','NOT USED (EMBED)','27'],
      ['VT 5','VTR 5 In (433-448)','28','433','434','435','436','437','438','439','440','441','442','443','444','445','446','447','448'],
      ['VT 6','VTR 6 In (449-464)','29','449','450','451','452','453','454','455','456','457','458','459','460','461','462','463','464'],
      ['ENCODE 1','Sat Encoder 1 (465-480)','30','465','466','467','468','469','470','471','472','473','474','475','476','477','478','479','480'],
      ['ENCODE 2','Sat Encoder 2 (481-496)','31','481','482','483','484','485','486','487','488','489','490','491','492','493','494','495','496'],
      ['TX1 DA','TX1 DA In (497-512)','32','497','498','499','500','501','502','503','504','505','506','507','508','509','510','511','512'],
      ['TX2 DA','TX2 DA In (513-528)','33','513','514','515','516','517','518','519','520','521','522','523','524','525','526','527','528'],
      ['PGM DA','PGM DA In (529-544)','34','529','530','531','532','533','534','535','536','537','538','539','540','541','542','543','544'],
      ['ISO DA','ISO DA In (545-560)','35','545','546','547','548','549','550','551','552','553','554','555','556','557','558','559','560'],
      ['Out 036','NOT USED (EMBED)','36'],
      ['EIC QC 1','EIC QC - Rack (577-592)','37','577','578','579','580','581','582','583','584','585','586','587','588','589','590','591','592'],
      ['EIC QC 2','EIC QC - Desk (593-608)','38','593','594','595','596','597','598','599','600','601','602','603','604','605','606','607','608'],
      ['TAPE QC','Tape QC Monitor (609-624)','39','609','610','611','612','613','614','615','616','617','618','619','620','621','622','623','624'],
      ['A1 WHLR','A1 SDI Wohler (625-640)','40','625','626','627','628','629','630','631','632','633','634','635','636','637','638','639','640'],
      ['IO BNC 1','I/O Router Out 1 (641-656)','41','641','642','643','644','645','646','647','648','649','650','651','652','653','654','655','656'],
      ['IO BNC 2','I/O Router Out 2 (657-672)','42','657','658','659','660','661','662','663','664','665','666','667','668','669','670','671','672'],
      ['IO BNC 3','I/O Router Out 3 (673-688)','43','673','674','675','676','677','678','679','680','681','682','683','684','685','686','687','688'],
      ['IO BNC 4','I/O Router Out 4 (689-704)','44','689','690','691','692','693','694','695','696','697','698','699','700','701','702','703','704'],
      ['Out 045','NOT USED (EMBED)','45'],
      ['IO BNC 5','I/O Router Out 5 (721-736)','46','721','722','723','724','725','726','727','728','729','730','731','732','733','734','735','736'],
      ['IO BNC 6','I/O Router Out 6 (737-752)','47','737','738','739','740','741','742','743','744','745','746','747','748','749','750','751','752'],
      ['IO BNC 7','I/O Router Out 7 (753-768)','48','753','754','755','756','757','758','759','760','761','762','763','764','765','766','767','768'],
      ['IO BNC 8','I/O Router Out 8 (769-784)','49','769','770','771','772','773','774','775','776','777','778','779','780','781','782','783','784'],
      ['IO BNC 9','I/O Router Out 9 (785-800)','50','785','786','787','788','789','790','791','792','793','794','795','796','797','798','799','800'],
      ['IO BNC10','I/O Router Out 10 (801-816)','51','801','802','803','804','805','806','807','808','809','810','811','812','813','814','815','816'],
      ['IO BNC11','I/O Router Out 11 (817-832)','52','817','818','819','820','821','822','823','824','825','826','827','828','829','830','831','832'],
      ['IO BNC12','I/O Router Out 12 (833-848)','53','833','834','835','836','837','838','839','840','841','842','843','844','845','846','847','848'],
      ['Out 054','NOT USED (EMBED)','54'],
      ['IO BNC13','I/O Router Out 13 (865-880)','55','865','866','867','868','869','870','871','872','873','874','875','876','877','878','879','880'],
      ['IO BNC14','I/O Router Out 14 (881-896)','56','881','882','883','884','885','886','887','888','889','890','891','892','893','894','895','896'],
      ['IO BNC15','I/O Router Out 15 (897-912)','57','897','898','899','900','901','902','903','904','905','906','907','908','909','910','911','912'],
      ['IO BNC16','I/O Router Out 16 (913-928)','58','913','914','915','916','917','918','919','920','921','922','923','924','925','926','927','928'],
      ['IO FIB01','I/O Fiber Out 1 (929-944)','59','929','930','931','932','933','934','935','936','937','938','939','940','941','942','943','944'],
      ['IO FIB02','I/O Fiber Out 2 (945-960)','60','945','946','947','948','949','950','951','952','953','954','955','956','957','958','959','960'],
      ['IO FIB03','I/O Fiber Out 3 (961-976)','61','961','962','963','964','965','966','967','968','969','970','971','972','973','974','975','976'],
      ['IO FIB04','I/O Fiber Out 4 (977-992)','62','977','978','979','980','981','982','983','984','985','986','987','988','989','990','991','992'],
      ['Out 063','NOT USED (EMBED)','63'],
      ['IO FIB05','I/O Fiber Out 5 (1009-1024)','64','1009','1010','1011','1012','1013','1014','1015','1016','1017','1018','1019','1020','1021','1022','1023','1024'],
      ['IO FIB06','I/O Fiber Out 6 (1025-1040)','65','1025','1026','1027','1028','1029','1030','1031','1032','1033','1034','1035','1036','1037','1038','1039','1040'],
      ['IO FIB07','I/O Fiber Out 7 (1041-1056)','66','1041','1042','1043','1044','1045','1046','1047','1048','1049','1050','1051','1052','1053','1054','1055','1056'],
      ['IO FIB08','I/O Fiber Out 8 (1057-1072)','67','1057','1058','1059','1060','1061','1062','1063','1064','1065','1066','1067','1068','1069','1070','1071','1072'],
      ['IO FIB09','I/O Fiber Out 9 (1073-1088)','68','1073','1074','1075','1076','1077','1078','1079','1080','1081','1082','1083','1084','1085','1086','1087','1088'],
      ['IO FIB10','I/O Fiber Out 10 (1089-1104)','69','1089','1090','1091','1092','1093','1094','1095','1096','1097','1098','1099','1100','1101','1102','1103','1104'],
      ['IO FIB11','I/O Fiber Out 11 (1105-1120)','70','1105','1106','1107','1108','1109','1110','1111','1112','1113','1114','1115','1116','1117','1118','1119','1120'],
      ['IO FIB12','I/O Fiber Out 12 (1121-1136)','71','1121','1122','1123','1124','1125','1126','1127','1128','1129','1130','1131','1132','1133','1134','1135','1136'],
      ['Out 072','NOT USED (EMBED)','72'],
      ['IO FIB13','I/O Fiber Out 13 (1153-1168)','73','1153','1154','1155','1156','1157','1158','1159','1160','1161','1162','1163','1164','1165','1166','1167','1168'],
      ['IO FIB14','I/O Fiber Out 14 (1169-1184)','74','1169','1170','1171','1172','1173','1174','1175','1176','1177','1178','1179','1180','1181','1182','1183','1184'],
      ['IO FIB15','I/O Fiber Out 15 (1185-1200)','75','1185','1186','1187','1188','1189','1190','1191','1192','1193','1194','1195','1196','1197','1198','1199','1200'],
      ['IO FIB16','I/O Fiber Out 16 (1201-1216)','76','1201','1202','1203','1204','1205','1206','1207','1208','1209','1210','1211','1212','1213','1214','1215','1216'],
      ['MUX 2-1','Embedder 77 (1217-1232)','77','1217','1218','1219','1220','1221','1222','1223','1224','1225','1226','1227','1228','1229','1230','1231','1232'],
      ['MUX 2-2','Embedder 78 (1233-1248)','78','1233','1234','1235','1236','1237','1238','1239','1240','1241','1242','1243','1244','1245','1246','1247','1248'],
      ['MUX 2-3','Embedder 79 (1249-1264)','79','1249','1250','1251','1252','1253','1254','1255','1256','1257','1258','1259','1260','1261','1262','1263','1264'],
      ['MUX 2-4','Embedder 80 (1265-1280)','80','1265','1266','1267','1268','1269','1270','1271','1272','1273','1274','1275','1276','1277','1278','1279','1280'],
      ['MUX 2-5','N/A','81'],
      ['MUX 2-6','Embedder 81 (1297-1312)','82','1297','1298','1299','1300','1301','1302','1303','1304','1305','1306','1307','1308','1309','1310','1311','1312'],
      ['EMB 83','Embedder 82 (1313-1328)','83','1313','1314','1315','1316','1317','1318','1319','1320','1321','1322','1323','1324','1325','1326','1327','1328'],
      ['EMB 84','Embedder 83 (1329-1344)','84','1329','1330','1331','1332','1333','1334','1335','1336','1337','1338','1339','1340','1341','1342','1343','1344'],
      ['EMB 85','Embedder 84 (1345-1360)','85','1345','1346','1347','1348','1349','1350','1351','1352','1353','1354','1355','1356','1357','1358','1359','1360'],
      ['EMB 86','Embedder 85 (1361-1376)','86','1361','1362','1363','1364','1365','1366','1367','1368','1369','1370','1371','1372','1373','1374','1375','1376'],
      ['EMB 87','Embedder 86 (1377-1392)','87','1377','1378','1379','1380','1381','1382','1383','1384','1385','1386','1387','1388','1389','1390','1391','1392'],
      ['EMB 88','Embedder 87 (1393-1408)','88','1393','1394','1395','1396','1397','1398','1399','1400','1401','1402','1403','1404','1405','1406','1407','1408'],
      ['EMB 89','Embedder 88 (1409-1424)','89','1409','1410','1411','1412','1413','1414','1415','1416','1417','1418','1419','1420','1421','1422','1423','1424'],
      ['Out 090','N/A','90'],
      ['CG1 IN','CG1 SDI Input','91'],
      ['CG2 IN','CG2 SDI Input','92'],
      ['CG3 IN','CG3 SDI Input','93'],
      ['CG4 IN','CG4 SDI Input','94'],
      ['BUG1 IN','Bug 1 SDI Input','95'],
      ['BUG2 IN','Bug 2 SDI Input','96'],
      ['Out 097','Spare Out 97','97'],
      ['Out 098','Spare Out 98','98'],
      ['MADI 1','MADI Output 1 - 1441-1504','99'],
      ['PXM 1','Production Monitor 1','100'],
      ['PXM 2','Production Monitor 2','101'],
      ['PXM 3','Production Monitor 3','102'],
      ['PXM 4','Production Monitor 4','103'],
      ['PXM 5','Production Monitor 5','104'],
      ['PXM 6','Production Monitor 6','105'],
      ['PXM 7','Production Monitor 7','106'],
      ['PXM 8','Production Monitor 8','107'],
      ['MADI 2','MADI Output 2 - 1585-1648','108'],
      ['PXM 9','Production Monitor 9','109'],
      ['P2 MON1','P2 Monitor 1','110'],
      ['P2 MON2','P2 Monitor 2','111'],
      ['P2 MON3','P2 Monitor 3','112'],
      ['P2 MON4','P2 Monitor 4','113'],
      ['P3 MON1','P3 Monitor 1','114'],
      ['P3 MON2','P3 Monitor 2','115'],
      ['P3 MON3','P3 Monitor 3','116'],
      ['MADI 3','MADI Output 3 - 1729-1792','117'],
      ['FEVSMON1','Front EVS Monitor 1','118'],
      ['FEVSMON2','Front EVS Monitor 2','119'],
      ['FEVSMON3','Front EVS Monitor 3','120'],
      ['REVSMON1','Rear EVS Monitor 1','121'],
      ['REVSMON2','Rear EVS Monitor 2','122'],
      ['REVSMON3','Rear EVS Monitor 3','123'],
      ['REVSMON4','Rear EVS Monitor 4','124'],
      ['VID MV 1','Video Upper Monitor 1','125'],
      ['MADI 4','MADI Output 4 - 1873-1936','126'],
      ['VID MV 2','Video Upper Monitor 2','127'],
      ['VID MV 3','Video Upper Monitor 3','128'],
      ['AUD MV 1','Audio Left Monitor','129'],
      ['AUD MV 2','Audio Right Monitor','130'],
      ['VID QC 1','Video QC Monitor 1','131'],
      ['VID QC 2','Video QC Monitor 2','132'],
      ['VID QC 3','Video QC Monitor 3','133'],
      ['RETURN 1','Camera Return DA 1 Input','134'],
      ['MADI 5','MADI Output 5 - 2017-2080','135'],
      ['RETURN 2','Camera Return DA 2 Input','136'],
      ['PXM 10','Production Monitor 10','137'],
      ['PXM 11','Production Monitor 11','138'],
      ['PXM 12','Production Monitor 12','139'],
      ['Out 140','Spare Output 140','140'],
      ['MV 1-1','Multiviewer Input 1-1','141'],
      ['MV 1-2','Multiviewer Input 1-2','142'],
      ['MV 1-3','Multiviewer Input 1-3','143'],
      ['MADI 6','MADI Output 6 - 2161-2224','144'],
      ['MV 1-4','Multiviewer Input 1-4','145'],
      ['MV 1-5','Multiviewer Input 1-5','146'],
      ['MV 1-6','Multiviewer Input 1-6','147'],
      ['MV 1-7','Multiviewer Input 1-7','148'],
      ['MV 1-8','Multiviewer Input 1-8','149'],
      ['MV 1-9','Multiviewer Input 1-9','150'],
      ['MV 2-1','Multiviewer Input 2-1','151'],
      ['MV 2-2','Multiviewer Input 2-2','152'],
      ['MV 2-3','Multiviewer Input 2-3','153'],
      ['MV 2-4','Multiviewer Input 2-4','154'],
      ['MV 2-5','Multiviewer Input 2-5','155'],
      ['MV 2-6','Multiviewer Input 2-6','156'],
      ['MV 2-7','Multiviewer Input 2-7','157'],
      ['MV 2-8','Multiviewer Input 2-8','158'],
      ['MV 2-9','Multiviewer Input 2-9','159'],
      ['MV 3-1','Multiviewer Input 3-1','160'],
      ['MV 3-2','Multiviewer Input 3-2','161'],
      ['MV 3-3','Multiviewer Input 3-3','162'],
      ['MV 3-4','Multiviewer Input 3-4','163'],
      ['MV 3-5','Multiviewer Input 3-5','164'],
      ['MV 3-6','Multiviewer Input 3-6','165'],
      ['MV 3-7','Multiviewer Input 3-7','166'],
      ['MV 3-8','Multiviewer Input 3-8','167'],
      ['MV 3-9','Multiviewer Input 3-9','168'],
      ['MV 4-1','Multiviewer Input 4-1','169'],
      ['MV 4-2','Multiviewer Input 4-2','170'],
      ['MV 4-3','Multiviewer Input 4-3','171'],
      ['MV 4-4','Multiviewer Input 4-4','172'],
      ['MV 4-5','Multiviewer Input 4-5','173'],
      ['MV 4-6','Multiviewer Input 4-6','174'],
      ['MV 4-7','Multiviewer Input 4-7','175'],
      ['MV 4-8','Multiviewer Input 4-8','176'],
      ['MV 4-9','Multiviewer Input 4-9','177'],
      ['MV 5-1','Multiviewer Input 5-1','178'],
      ['MV 5-2','Multiviewer Input 5-2','179'],
      ['MV 5-3','Multiviewer Input 5-3','180'],
      ['MV 5-4','Multiviewer Input 5-4','181'],
      ['MV 5-5','Multiviewer Input 5-5','182'],
      ['MV 5-6','Multiviewer Input 5-6','183'],
      ['MV 5-7','Multiviewer Input 5-7','184'],
      ['MV 5-8','Multiviewer Input 5-8','185'],
      ['MV 5-9','Multiviewer Input 5-9','186'],
      ['MV 6-1','Multiviewer Input 6-1','187'],
      ['MV 6-2','Multiviewer Input 6-2','188'],
      ['MV 6-3','Multiviewer Input 6-3','189'],
      ['MV 6-4','Multiviewer Input 6-4','190'],
      ['MV 6-5','Multiviewer Input 6-5','191'],
      ['MV 6-6','Multiviewer Input 6-6','192'],
      ['MV 6-7','Multiviewer Input 6-7','193'],
      ['MV 6-8','Multiviewer Input 6-8','194'],
      ['MV 6-9','Multiviewer Input 6-9','195'],
      ['MV 7-1','Multiviewer Input 7-1','196'],
      ['MV 7-2','Multiviewer Input 7-2','197'],
      ['MV 7-3','Multiviewer Input 7-3','198'],
      ['MV 7-4','Multiviewer Input 7-4','199'],
      ['MV 7-5','Multiviewer Input 7-5','200'],
      ['MV 7-6','Multiviewer Input 7-6','201'],
      ['MV 7-7','Multiviewer Input 7-7','202'],
      ['MV 7-8','Multiviewer Input 7-8','203'],
      ['MV 7-9','Multiviewer Input 7-9','204'],
      ['MV 8-1','Multiviewer Input 8-1','205'],
      ['MV 8-2','Multiviewer Input 8-2','206'],
      ['MV 8-3','Multiviewer Input 8-3','207'],
      ['MV 8-4','Multiviewer Input 8-4','208'],
      ['MV 8-5','Multiviewer Input 8-5','209'],
      ['MV 8-6','Multiviewer Input 8-6','210'],
      ['MV 8-7','Multiviewer Input 8-7','211'],
      ['MV 8-8','Multiviewer Input 8-8','212'],
      ['MV 8-9','Multiviewer Input 8-9','213'],
      ['MV 9-1','Multiviewer Input 9-1','214'],
      ['MV 9-2','Multiviewer Input 9-2','215'],
      ['MV 9-3','Multiviewer Input 9-3','216'],
      ['MV 9-4','Multiviewer Input 9-4','217'],
      ['MV 9-5','Multiviewer Input 9-5','218'],
      ['MV 9-6','Multiviewer Input 9-6','219'],
      ['MV 9-7','Multiviewer Input 9-7','220'],
      ['MV 9-8','Multiviewer Input 9-8','221'],
      ['MV 9-9','Multiviewer Input 9-9','222'],
      ['MV 10-1','Multiviewer Input 10-1','223'],
      ['MV 10-2','Multiviewer Input 10-2','224'],
      ['MV 10-3','Multiviewer Input 10-3','225'],
      ['MV 10-4','Multiviewer Input 10-4','226'],
      ['MV 10-5','Multiviewer Input 10-5','227'],
      ['MV 10-6','Multiviewer Input 10-6','228'],
      ['MV 10-7','Multiviewer Input 10-7','229'],
      ['MV 10-8','Multiviewer Input 10-8','230'],
      ['MV 10-9','Multiviewer Input 10-9','231'],
      ['MV 11-1','Multiviewer Input 11-1','232'],
      ['MV 11-2','Multiviewer Input 11-2','233'],
      ['MV 11-3','Multiviewer Input 11-3','234'],
      ['MV 11-4','Multiviewer Input 11-4','235'],
      ['MV 11-5','Multiviewer Input 11-5','236'],
      ['MV 11-6','Multiviewer Input 11-6','237'],
      ['MV 11-7','Multiviewer Input 11-7','238'],
      ['MV 11-8','Multiviewer Input 11-8','239'],
      ['MV 11-9','Multiviewer Input 11-9','240'],
      ['MV 12-1','Multiviewer Input 12-1','241'],
      ['MV 12-2','Multiviewer Input 12-2','242'],
      ['MV 12-3','Multiviewer Input 12-3','243'],
      ['MV 12-4','Multiviewer Input 12-4','244'],
      ['MV 12-5','Multiviewer Input 12-5','245'],
      ['MV 12-6','Multiviewer Input 12-6','246'],
      ['MV 12-7','Multiviewer Input 12-7','247'],
      ['MV 12-8','Multiviewer Input 12-8','248'],
      ['MV 12-9','Multiviewer Input 12-9','249'],
      ['MV 13-1','Multiviewer Input 13-1','250'],
      ['MV 13-2','Multiviewer Input 13-2','251'],
      ['MV 13-3','Multiviewer Input 13-3','252'],
      ['MV 13-4','Multiviewer Input 13-4','253'],
      ['MV 13-5','Multiviewer Input 13-5','254'],
      ['MV 13-6','Multiviewer Input 13-6','255'],
      ['MV 13-7','Multiviewer Input 13-7','256'],
      ['MV 13-8','Multiviewer Input 13-8','257'],
      ['MV 13-9','Multiviewer Input 13-9','258'],
      ['MV 14-1','Multiviewer Input 14-1','259'],
      ['MV 14-2','Multiviewer Input 14-2','260'],
      ['MV 14-3','Multiviewer Input 14-3','261'],
      ['MV 14-4','Multiviewer Input 14-4','262'],
      ['MV 14-5','Multiviewer Input 14-5','263'],
      ['MV 14-6','Multiviewer Input 14-6','264'],
      ['MV 14-7','Multiviewer Input 14-7','265'],
      ['MV 14-8','Multiviewer Input 14-8','266'],
      ['MV 14-9','Multiviewer Input 14-9','267'],
      ['MV 15-1','Multiviewer Input 15-1','268'],
      ['MV 15-2','Multiviewer Input 15-2','269'],
      ['MV 15-3','Multiviewer Input 15-3','270'],
      ['MV 15-4','Multiviewer Input 15-4','271'],
      ['MV 15-5','Multiviewer Input 15-5','272'],
      ['MV 15-6','Multiviewer Input 15-6','273'],
      ['MV 15-7','Multiviewer Input 15-7','274'],
      ['MV 15-8','Multiviewer Input 15-8','275'],
      ['MV 15-9','Multiviewer Input 15-9','276'],
      ['MV 16-1','Multiviewer Input 16-1','277'],
      ['MV 16-2','Multiviewer Input 16-2','278'],
      ['MV 16-3','Multiviewer Input 16-3','279'],
      ['MV 16-4','Multiviewer Input 16-4','280'],
      ['MV 16-5','Multiviewer Input 16-5','281'],
      ['MV 16-6','Multiviewer Input 16-6','282'],
      ['MV 16-7','Multiviewer Input 16-7','283'],
      ['MV 16-8','Multiviewer Input 16-8','284'],
      ['MV 16-9','Multiviewer Input 16-9','285'],
      ['MV 17-1','Multiviewer Input 17-1','286'],
      ['MV 17-2','Multiviewer Input 17-2','287'],
      ['MV 17-3','Multiviewer Input 17-3','288'],
      ['MV 17-4','Multiviewer Input 17-4','289'],
      ['MV 17-5','Multiviewer Input 17-5','290'],
      ['MV 17-6','Multiviewer Input 17-6','291'],
      ['MV 17-7','Multiviewer Input 17-7','292'],
      ['MV 17-8','Multiviewer Input 17-8','293'],
      ['MV 17-9','Multiviewer Input 17-9','294'],
      ['MV 18-1','Multiviewer Input 18-1','295'],
      ['MV 18-2','Multiviewer Input 18-2','296'],
      ['MV 18-3','Multiviewer Input 18-3','297'],
      ['MV 18-4','Multiviewer Input 18-4','298'],
      ['MV 18-5','Multiviewer Input 18-5','299'],
      ['MV 18-6','Multiviewer Input 18-6','300'],
      ['MV 18-7','Multiviewer Input 18-7','301'],
      ['MV 18-8','Multiviewer Input 18-8','302'],
      ['MV 18-9','Multiviewer Input 18-9','303'],
      ['MV 19-1','Multiviewer Input 19-1','304'],
      ['MV 19-2','Multiviewer Input 19-2','305'],
      ['MV 19-3','Multiviewer Input 19-3','306'],
      ['MV 19-4','Multiviewer Input 19-4','307'],
      ['MV 19-5','Multiviewer Input 19-5','308'],
      ['MV 19-6','Multiviewer Input 19-6','309'],
      ['MV 19-7','Multiviewer Input 19-7','310'],
      ['MV 19-8','Multiviewer Input 19-8','311'],
      ['MV 19-9','Multiviewer Input 19-9','312'],
      ['MV 20-1','Multiviewer Input 20-1','313'],
      ['MV 20-2','Multiviewer Input 20-2','314'],
      ['MV 20-3','Multiviewer Input 20-3','315'],
      ['MV 20-4','Multiviewer Input 20-4','316'],
      ['MV 20-5','Multiviewer Input 20-5','317'],
      ['MV 20-6','Multiviewer Input 20-6','318'],
      ['MV 20-7','Multiviewer Input 20-7','319'],
      ['MV 20-8','Multiviewer Input 20-8','320'],
      ['MV 20-9','Multiviewer Input 20-9','321'],
      ['MV 21-1','Multiviewer Input 21-1','322'],
      ['MV 21-2','Multiviewer Input 21-2','323'],
      ['MV 21-3','Multiviewer Input 21-3','324'],
      ['MV 21-4','Multiviewer Input 21-4','325'],
      ['MV 21-5','Multiviewer Input 21-5','326'],
      ['MV 21-6','Multiviewer Input 21-6','327'],
      ['MV 21-7','Multiviewer Input 21-7','328'],
      ['MV 21-8','Multiviewer Input 21-8','329'],
      ['MV 21-9','Multiviewer Input 21-9','330'],
      ['MV 22-1','Multiviewer Input 22-1','331'],
      ['MV 22-2','Multiviewer Input 22-2','332'],
      ['MV 22-3','Multiviewer Input 22-3','333'],
      ['MV 22-4','Multiviewer Input 22-4','334'],
      ['MV 22-5','Multiviewer Input 22-5','335'],
      ['MV 22-6','Multiviewer Input 22-6','336'],
      ['MV 22-7','Multiviewer Input 22-7','337'],
      ['MV 22-8','Multiviewer Input 22-8','338'],
      ['MV 22-9','Multiviewer Input 22-9','339'],
      ['MV 24-1','Multiviewer Input 24-1','340'],
      ['MV 24-2','Multiviewer Input 24-2','341'],
      ['MV 24-3','Multiviewer Input 24-3','342'],
      ['MV 24-4','Multiviewer Input 24-4','343'],
      ['MV 24-5','Multiviewer Input 24-5','344'],
      ['MV 24-6','Multiviewer Input 24-6','345'],
      ['MV 24-7','Multiviewer Input 24-7','346'],
      ['MV 24-8','Multiviewer Input 24-8','347'],
      ['MV 24-9','Multiviewer Input 24-9','348'],
      ['MV 24-10','Multiviewer Input 24-10','349'],
    ];
    const devices = _D.map((d, i) => {
      const audio = Array(16).fill('');
      for (let a = 0; a < 16 && a + 3 < d.length; a++) {
        audio[a] = d[a + 3] || '';
      }
      return { row: i + 1, deviceName: d[0] || '', deviceDesc: d[1] || '', videoLevel: d[2] || '', audio };
    });
    // Pad to 350 total rows for custom additions
    while (devices.length < 350) {
      devices.push({ row: devices.length + 1, deviceName: '', deviceDesc: '', videoLevel: '', audio: Array(16).fill('') });
    }
    return devices;
  }

  // Default SWR I/O data from MU-21 showbook
  function defaultSwrIo() {
    // Switcher Inputs (1-120): engSource defaults
    const inputDefaults = [
      'CCU 01', 'CCU 02', 'CCU 03', 'CCU 04', 'CCU 05', 'CCU 06', 'CCU 07', 'CCU 08',
      'CCU 09', 'CCU 10', 'CCU 11', 'CCU 12', 'FS 01', 'FS 02', 'FS 03', 'FS 04',
      'FS 05', 'FS 06', 'FS 07', 'FS 08', 'FS 09', 'FS 10', 'FS 11', 'FS 12',
      'FS 13', 'FS 14', 'FS 15', 'FS 16', 'FS 17', 'FS 18', 'FS 19', 'FS 20',
      'EVS 1-A', 'EVS 1-B', 'EVS 2-A', 'EVS 2-B', 'EVS 3-A', 'EVS 3-B',
      'SPOT 1', 'SPOT 2', 'SPOT 3', 'SPOT 4', 'FS 21', 'FS 22', 'FS 23', 'FS 24',
      'BARS', 'BLACK',
      // 49-96
      'TX3 DA', 'TX4 DA', 'TX5 DA', 'TX6 DA', 'TX7 DA', 'TX8 DA',
      'CG 1 FILL', 'CG 1 KEY', 'CG 2 FILL', 'CG 2 KEY', 'CG 3 FILL', 'CG 3 KEY',
      'CG 4 FILL', 'CG 4 KEY', 'BUG 1 FILL', 'BUG 1 KEY', 'BUG 2 FILL', 'BUG 2 KEY',
      'FS 25', 'FS 26', 'FS 27', 'FS 28', 'FS 29', 'FS 30', 'FS 31', 'FS 32',
      'FS 33', 'FS 34', 'FS 35', 'FS 36', 'FS 37', 'FS 38', 'FS 39', 'FS 40',
      'FS 41', 'FS 42', 'FS 43', 'FS 44', 'FS 45', 'FS 46', 'FS 47', 'FS 48',
      'FS 49', 'FS 50', 'FS 51', 'FS 52', 'FS 53', 'FS 54',
      // 97-120
      'FS 56', 'FS 57', 'FS 58', 'FS 59', 'FS 60', 'FS 61', 'FS 62', 'FS 63',
      'FS 64', 'FS 65', 'FS 66', 'FS 67', 'FS 68', 'FS 69', 'FS 70', '',
      '', '', '', '', 'VALID', '', '', ''
    ];
    const inputs = Array.from({ length: 120 }, (_, i) => ({
      row: i + 1,
      showSource: '',
      engSource: inputDefaults[i] || '',
    }));

    // Switcher Outputs (1-46): defaultShow values
    const outputDefaults = [
      'PGM A', 'CLEAN', 'PRESET', 'SWPVW', 'ME1 PVW', 'ME1 A', 'ME1 B', 'ME1 C', 'ME1 D',
      'ME2 PVW', 'ME2 A', 'ME2 B', 'ME2 C', 'ME2 D',
      'ME3 PVW', 'ME3 A', 'ME3 B', 'ME3 C', 'ME3 D',
      'ME4 PVW', 'ME4 A', 'ME4 B', 'ME4 C', 'ME4 D',
      'AUX 1', 'AUX 2', 'AUX 3', 'AUX 4', 'AUX 5', 'AUX 6', 'AUX 7', 'AUX 8',
      'AUX 9', 'AUX 10', 'AUX 11', 'AUX 12',
      'IS 1', 'IS 1', 'IS 3', 'IS 4', 'IS 5', 'IS 6', 'IS 7', 'IS 8', 'IS 9', 'IS 10'
    ];
    const outputs = Array.from({ length: 46 }, (_, i) => ({
      row: i + 1,
      defaultShow: outputDefaults[i] || '',
      show: outputDefaults[i] || '',
    }));

    // SWR Tally Group (1-24)
    const tallyDefaults = [
      'CCU 1', 'CCU 2', 'CCU 3', 'CCU 4', 'CCU 5', 'CCU 6',
      'CCU 7', 'CCU 8', 'CCU 9', 'CCU 10', 'CCU 11', 'CCU 12',
      'AUTO FADER 1', 'AUTO FADER 2', 'AUTO FADER 3', 'AUTO FADER 4',
      'AUTO FADER 5', 'AUTO FADER 6', 'AUTO FADER 7', 'AUTO FADER 8',
      'SPARE 1', 'SPARE 2', 'SPARE 3', 'SPARE 4'
    ];
    const tally = Array.from({ length: 24 }, (_, i) => ({
      row: i + 1,
      default: tallyDefaults[i] || '',
      show: '',
    }));

    // SWR GPI Group (1-12)
    const gpiDefaults = [
      'EVS 1-1', 'EVS 1-2', 'EVS 2-1', 'EVS 2-2', 'EVS 3-1', 'EVS 3-2',
      '', '', '', '', '', ''
    ];
    const gpi = Array.from({ length: 12 }, (_, i) => ({
      row: i + 1,
      default: gpiDefaults[i] || '',
      show: '',
    }));

    return { inputs, outputs, tally, gpi };
  }

  // Default VIDEO I/O data
  function defaultVideoIo() {
    // Fiber RTR Outputs (16 rows): source, destination, tac, fibA
    const fiberRtrOut = Array.from({ length: 16 }, (_, i) => ({
      row: i + 1,
      source: '',
      destination: '',
      tac: '',
      fibA: '',
    }));

    // Coax RTR Outputs (16 rows): source, destination, mult, coax
    const coaxRtrOut = Array.from({ length: 16 }, (_, i) => ({
      row: i + 1,
      source: '',
      destination: '',
      mult: '',
      coax: '',
    }));

    // Coax I/O Tie Lines (48 rows) with fixed destinations
    const tieLineDestinations = [
      'P1-1', 'P1-2', 'P1-3', 'P1-4', 'P1-5', 'P1-6', 'P1-7', 'P1-8',
      'P2-1', 'P2-2', 'P2-3', 'P2-4', 'P2-5', 'P2-6', 'P2-7', 'P2-8',
      'P3-1', 'P3-2', 'P3-3', 'P3-4', 'P3-5', 'P3-6', 'P3-7', 'P3-8',
      'FEVS-1', 'FEVS-2', 'FEVS-3', 'FEVS-4', 'FEVS-5', 'FEVS-6',
      'FEVS-7', 'FEVS-8', 'FEVS-9', 'FEVS-10', 'FEVS-11', 'FEVS-12',
      'REVS-1', 'REVS-2', 'REVS-3', 'REVS-4', 'REVS-5', 'REVS-6',
      'REVS-7', 'REVS-8', 'REVS-9', 'REVS-10', 'REVS-11', 'REVS-12',
    ];
    const coaxIoTieLines = Array.from({ length: 48 }, (_, i) => ({
      row: i + 1,
      source: '',
      destination: tieLineDestinations[i] || '',
      mult: '',
      coax: '',
    }));

    // Coax Truck Tie Lines (48 rows): source, destination
    const coaxTruckTieLines = Array.from({ length: 48 }, (_, i) => ({
      row: i + 1,
      source: '',
      destination: tieLineDestinations[i] || '',
    }));

    // JFS MUX 1 (12 rows): source, destination, faxed + TAC/Strand for entire unit
    const jfsMux1 = {
      tac: '',    // TAC panel assignment for entire MUX 1
      fibA: '',   // Fiber strand assignment for entire MUX 1
      rows: Array.from({ length: 12 }, (_, i) => ({
        row: i + 1,
        source: '',
        destination: '',
        faxed: false,
      })),
    };

    // JFS MUX 2 (6 rows): source, destination, faxed + TAC/Strand for entire unit
    const jfsMux2 = {
      tac: '',    // TAC panel assignment for entire MUX 2
      fibA: '',   // Fiber strand assignment for entire MUX 2
      rows: Array.from({ length: 6 }, (_, i) => ({
        row: i + 1,
        source: '',
        destination: '',
        faxed: false,
      })),
    };

    return { fiberRtrOut, coaxRtrOut, coaxIoTieLines, coaxTruckTieLines, jfsMux1, jfsMux2 };
  }

  // Default EVS CONFIG data
  function defaultEvsConfig() {
    // EVS Server definitions from the sheet
    const serverDefs = [
      { id: '2101', sn: '310160', mod: 'XT VIA', pos: 'REVS 1', config: '6X2', xnet: 1 },
      { id: '2102', sn: '310170', mod: 'XT VIA', pos: 'FEVS 2', config: '6X2', xnet: 2 },
      { id: '2103', sn: '310140', mod: 'XT VIA', pos: 'FEVS 1', config: '6X2', xnet: 3 },
      { id: '2105', sn: '310110', mod: 'Xs VIA', pos: 'TD', config: '0X4', xnet: 20 },
    ];

    // Default channel names per server - MATCHES RTR I/O MASTER naming
    // ENG names: Inputs use EVSx-Xin format, Outputs use EVS x-Xs format
    // SHOW names: Inputs default to EVS X-X IN, Outputs empty for 2101/2102
    const channelDefaults = {
      '2101': [
        { ch: 1, engName: 'EVS1-Ain', showName: 'EVS 1-1 IN' },
        { ch: 2, engName: 'EVS1-Bin', showName: 'EVS 1-2 IN' },
        { ch: 3, engName: 'EVS1-Cin', showName: 'EVS 1-3 IN' },
        { ch: 4, engName: 'EVS1-Din', showName: 'EVS 1-4 IN' },
        { ch: 5, engName: 'EVS1-Ein', showName: 'EVS 1-5 IN' },
        { ch: 6, engName: 'EVS1-Fin', showName: 'EVS 1-6 IN' },
        { ch: 7, engName: 'EVS 1-As', showName: '', isOutput: true },
        { ch: 8, engName: 'EVS 1-Bs', showName: '', isOutput: true },
      ],
      '2102': [
        { ch: 1, engName: 'EVS2-Ain', showName: 'EVS 2-1 IN' },
        { ch: 2, engName: 'EVS2-Bin', showName: 'EVS 2-2 IN' },
        { ch: 3, engName: 'EVS2-Cin', showName: 'EVS 2-3 IN' },
        { ch: 4, engName: 'EVS2-Din', showName: 'EVS 2-4 IN' },
        { ch: 5, engName: 'EVS2-Ein', showName: 'EVS 2-5 IN' },
        { ch: 6, engName: 'EVS2-Fin', showName: 'EVS 2-6 IN' },
        { ch: 7, engName: 'EVS 2-As', showName: '', isOutput: true },
        { ch: 8, engName: 'EVS 2-Bs', showName: '', isOutput: true },
      ],
      '2103': [
        { ch: 1, engName: 'EVS3-Ain', showName: 'EVS 3-1 IN' },
        { ch: 2, engName: 'EVS3-Bin', showName: 'EVS 3-2 IN' },
        { ch: 3, engName: 'EVS3-Cin', showName: 'EVS 3-3 IN' },
        { ch: 4, engName: 'EVS3-Din', showName: 'EVS 3-4 IN' },
        { ch: 5, engName: 'EVS3-Ein', showName: 'EVS 3-5 IN' },
        { ch: 6, engName: 'EVS3-Fin', showName: 'EVS 3-6 IN' },
        { ch: 7, engName: 'EVS 3-As', showName: 'EVS 3-1 OUT', isOutput: true },
        { ch: 8, engName: 'EVS 3-Bs', showName: 'EVS 3-2 OUT', isOutput: true },
      ],
      '2105': [
        { ch: 1, engName: 'SPOT 1', showName: 'SPOT 1' },
        { ch: 2, engName: 'SPOT 2', showName: 'SPOT 2' },
        { ch: 3, engName: 'SPOT 3', showName: 'SPOT 3' },
        { ch: 4, engName: 'SPOT 4', showName: 'SPOT 4' },
        { ch: 5, engName: '', showName: '' },
        { ch: 6, engName: '', showName: '' },
        { ch: 7, engName: '', showName: '' },
        { ch: 8, engName: '', showName: '' },
      ],
    };

    // Wohler defaults per server
    const wohlerDefaults = {
      '2101': ['REVS 1-1', 'REVS 1-2', 'REVS 1-3', 'REVS 1-4', 'REVS 2-1', 'REVS 2-2', 'REVS 2-3', 'REVS 2-4'],
      '2102': ['FEVS 3-1', 'FEVS 3-2', 'FEVS 3-3', 'FEVS 3-4', 'FEVS 4-1', 'FEVS 4-2', 'FEVS 4-3', 'FEVS 4-4'],
      '2103': ['FEVS 1-1', 'FEVS 1-2', 'FEVS 1-3', 'FEVS 1-4', 'FEVS 2-1', 'FEVS 2-2', 'FEVS 2-3', 'FEVS 2-4'],
      '2105': ['TD WOHLER 1', 'TD WOHLER 2', 'TD WOHLER 3', 'TD WOHLER 4', 'TD WOHLER 5', 'TD WOHLER 6', 'TD WOHLER 7', 'TD WOHLER 8'],
    };

    // Build servers array
    const servers = serverDefs.map((def, idx) => ({
      id: def.id,
      op: '',
      sn: def.sn,
      mod: def.mod,
      pos: def.pos,
      config: def.config,
      showName: '',
      engName: `EVS ${idx + 1}`,
      channels: channelDefaults[def.id].map(ch => ({
        channel: ch.ch,
        engName: ch.engName,
        showName: ch.showName,
        isOutput: ch.isOutput || false,
      })),
      network: {
        pcLan: `10.5.21.1${idx + 1}/16`,
        tenG: `192.168.201.21${idx + 1}/24`,
        xnet: def.xnet,
      },
      wohler: Array.from({ length: 8 }, (_, i) => ({
        channel: i + 1,
        description: '',  // User fills in description
        rtrOut: wohlerDefaults[def.id][i] || '',  // Default router output name
        isAnalog: def.id === '2105',
      })),
    }));

    // XFILE 1 gateway
    const xfile = {
      name: 'XFILE 1',
      pcLan: '10.5.21.10/16',
      tenG: '192.168.201.230/24',
      inet: 'DHCP',
      gateways: {
        pcLan: '10.5.21.1',
        tenG: '192.168.201.1',
      },
    };

    // SHOW SOURCES reference (ENG SOURCE, SHOW NAME, AUDIO) - 14 rows per column, 5 columns
    const showSourcesDefaults = [
      // Column 1 (EVS 2101)
      ['CCU 01', 'FS 01', 'SHOW03', 'SHOW04', 'SHOW05', 'SHOW06', 'SHOW07', 'SHOW08', 'SHOW09', 'SHOW10', 'SHOW11', 'SHOW12', 'SHOW13', 'SHOW14'],
      // Column 2 (EVS 2102)
      ['SHOW15', 'SHOW16', 'SHOW17', 'SHOW18', 'SHOW19', 'SHOW20', 'SHOW21', 'SHOW22', 'SHOW23', 'SHOW24', 'SHOW25', 'SHOW26', 'SHOW27', 'SHOW28'],
      // Column 3 (EVS 2103)
      ['SHOW29', 'SHOW30', 'SHOW31', 'SHOW32', 'SHOW33', 'SHOW34', 'SHOW35', 'SHOW36', 'SHOW37', 'SHOW38', 'SHOW39', 'SHOW40', 'SHOW41', 'SHOW42'],
      // Column 4 (EVS 2105)
      ['SHOW41', 'SHOW42', 'SHOW43', 'SHOW44', 'SHOW45', 'SHOW46', 'SHOW47', 'SHOW48', 'SHOW49', 'SHOW50', 'SHOW51', 'SHOW52', 'SHOW53', 'SHOW54'],
      // Column 5 (overflow)
      ['SHOW55', 'SHOW56', 'SHOW57', 'SHOW58', 'SHOW59', 'SHOW60', 'SHOW61', 'SHOW62', 'SHOW63', 'SHOW64', 'SHOW65', 'SHOW66', 'SHOW67', 'SHOW68'],
    ];

    const showSources = showSourcesDefaults.map((col, colIdx) =>
      col.map((engSource, rowIdx) => ({
        engSource,
        showName: '',
        audio: '*CNSLCAM',
      }))
    );

    return { servers, xfile, showSources };
  }

  // Default empty show template
  function emptyShow() {
    return {
      show: { name: '', format: '' },
      sources: Array.from({ length: 80 }, (_, i) => ({
        number: i + 1,
        showName: '',
        umdName: '',
        engSource: '',
        audioSource: '',
        active: false,
      })),
      txPgmGfx: {
        tx: Array.from({ length: 8 }, (_, i) => ({ row: i + 1, device: '', source: i === 0 ? 'TX1 DA' : i === 1 ? 'TX2 DA' : '', fiberPanel: '', fiberPort: '', notes: '' })),
        remi: Array.from({ length: 12 }, (_, i) => ({ row: i + 1, device: '', source: '', notes: '' })),
        cg: Array.from({ length: 6 }, (_, i) => ({ row: i + 1, device: '', source: '', notes: '' })),
        pgm: [{ row: 1, device: '', source: '', notes: '' }],
      },
      ccuFsy: {
        ccu: Array.from({ length: 12 }, (_, i) => ({
          unit: i + 1, device: 'GV XCU', coax: false, tac: '', fibA: '', fibB: '',
          lensB: false, lensS: false, lensW: false, lensDolly: false, lensHand: false, notes: ''
        })),
        fsy: Array.from({ length: 67 }, (_, i) => ({
          unit: i + 1, format: '', tac: '', fibA: '',
          mult: '', coax: '', fixed: '', js: '', notes: ''
        })),
      },
      rtrMaster: defaultRtrMaster(),
      rtrOutputs: defaultRtrOutputs(),
      sheet8: {
        deviceTypes: ['Camera', 'EVS', 'VTR', 'GFX', 'Router', 'Frame Sync', 'Switcher', 'Audio', 'Network', 'Fiber', 'Other'],
        videoFormats: ['1080i/59.94', '1080p/59.94', '720p/59.94', '2160p/59.94', 'SDI', 'HDMI', 'NDI', 'SRT'],
        audioFormats: ['AES', 'MADI', 'Dante', 'Analog', 'Embedded', 'SDI Emb'],
        locations: ['PCR', 'Studio', 'MCR', 'TOC', 'Truck', 'Field', 'Rack Room'],
        tacPanels: ['TAC-A', 'TAC-B', 'TAC-C', 'TAC-D', 'TAC-E', 'TAC-F', 'TAC-G', 'TAC-H', 'S09', 'S10'],
        audioSources: [
          '*CNSLCAM', '*CNSLPGM', '*GAME FX', '*GAMEPGM',
          'CNSL TX1', 'CNSL TX2',
          '*iso01', '*iso02', '*iso03', '*iso04', '*iso05', '*iso06',
          '*iso07', '*iso08', '*iso09', '*iso10', '*iso11', '*iso12',
          '*iso1&2', '*iso3&4', '*iso5&6', '*iso7&8', '*iso9&10', '*iso11&12',
          'REMI 01', 'REMI 02', 'REMI 03', 'REMI 04', 'REMI 05', 'REMI 06',
          'REMI 07', 'REMI 08', 'REMI 09', 'REMI 10', 'REMI 11', 'REMI 12',
          'CCU 01', 'CCU 02', 'CCU 03', 'CCU 04', 'CCU 05', 'CCU 06',
          'CCU 07', 'CCU 08', 'CCU 09', 'CCU 10', 'CCU 11', 'CCU 12',
          'FS 01', 'FS 02', 'FS 03', 'FS 04', 'FS 05', 'FS 06', 'FS 07', 'FS 08',
          'FS 09', 'FS 10', 'FS 11', 'FS 12', 'FS 13', 'FS 14', 'FS 15', 'FS 16',
          'FS 17', 'FS 18', 'FS 19', 'FS 20', 'FS 21', 'FS 22', 'FS 23', 'FS 24',
          'FS 25', 'FS 26', 'FS 27', 'FS 28', 'FS 29', 'FS 30', 'FS 31', 'FS 32',
          'FS 33', 'FS 34', 'FS 35', 'FS 36', 'FS 37', 'FS 38', 'FS 39', 'FS 40',
          'FS 41', 'FS 42', 'FS 43', 'FS 44', 'FS 45', 'FS 46', 'FS 47', 'FS 48',
          'FS 49', 'FS 50', 'FS 51', 'FS 52', 'FS 53', 'FS 54', 'FS 55', 'FS 56',
          'FS 57', 'FS 58', 'FS 59', 'FS 60', 'FS 61', 'FS 62',
        ],
        customDropdowns: {},
      },
      videoIo: defaultVideoIo(),
      fiberTac: {},
      swrIo: defaultSwrIo(),
      networkIo: {
        patchA: Array.from({ length: 24 }, (_, i) => ({ port: i + 1, device: '', ip: '', vlan: '', notes: '' })),
        patchB: Array.from({ length: 24 }, (_, i) => ({ port: i + 1, device: '', ip: '', vlan: '', notes: '' })),
      },
      evsConfig: defaultEvsConfig(),
      monitorWalls: {
        'prod-digital': Array.from({ length: 40 }, (_, i) => ({ position: i + 1, label: '', source: '', active: false })),
        'prod-print': Array.from({ length: 40 }, (_, i) => ({ position: i + 1, label: '', source: '', active: false })),
        'p2p3': Array.from({ length: 30 }, (_, i) => ({ position: i + 1, label: '', source: '', active: false })),
        'evs': Array.from({ length: 24 }, (_, i) => ({ position: i + 1, label: '', source: '', active: false })),
        'aud': Array.from({ length: 20 }, (_, i) => ({ position: i + 1, label: '', source: '', active: false })),
      },
      prodDigital: null, // Initialized by ProdDigitalTab.getDefaultProdDigitalData() on first render
      multiviewer: Array.from({ length: 25 }, (_, i) => ({
        mv: i + 1,
        windows: Array.from({ length: 16 }, (_, j) => ({ window: j + 1, source: '', label: '' })),
      })),
      coax: {
        mults: Array.from({ length: 40 }, (_, i) => ({ row: i + 1, source: '', dest1: '', dest2: '', dest3: '', dest4: '', notes: '' })),
        mux: Array.from({ length: 20 }, (_, i) => ({ row: i + 1, unit: '', input: '', output: '', notes: '' })),
      },
      audioMult: {
        dt1: Array.from({ length: 24 }, (_, i) => ({ row: i + 1, source: '', dest: '', notes: '' })),
        dt2: Array.from({ length: 24 }, (_, i) => ({ row: i + 1, source: '', dest: '', notes: '' })),
        dt3: Array.from({ length: 24 }, (_, i) => ({ row: i + 1, source: '', dest: '', notes: '' })),
        dt4: Array.from({ length: 24 }, (_, i) => ({ row: i + 1, source: '', dest: '', notes: '' })),
        dt5: Array.from({ length: 24 }, (_, i) => ({ row: i + 1, source: '', dest: '', notes: '' })),
        dt6: Array.from({ length: 24 }, (_, i) => ({ row: i + 1, source: '', dest: '', notes: '' })),
      },
      routerPanels: {
        form: Array.from({ length: 20 }, (_, i) => ({ row: i + 1, panelName: '', location: '', type: '', levels: '', notes: '' })),
        td: Array.from({ length: 20 }, (_, i) => ({ row: i + 1, button: '', source: '', dest: '', notes: '' })),
      },
      // Kaleido multiviewer layout control configuration
      kaleidoConfig: {
        bridgeUrl: 'http://localhost:3001',
        triggerMode: 'staged', // 'staged' or 'immediate'
        cards: Array.from({ length: 22 }, (_, i) => ({
          cardId: i + 1,
          ip: `192.168.23.${201 + i}`, // Default: 192.168.23.201 - 192.168.23.222
          port: 8902,
          enabled: true,
        })),
        stagedLayouts: {}, // { "1-1": { from: "9_SPLIT", to: "6_SPLIT_R", cardId: 1 }, ... }
      },
    };
  }

  // Initialize the TAC data
  function initTacData() {
    const panels = ['TAC-A', 'TAC-B', 'TAC-C', 'TAC-D', 'TAC-E', 'TAC-F', 'TAC-G', 'TAC-H', 'S09', 'S10'];
    const tac = {};
    panels.forEach(p => {
      tac[p] = Array.from({ length: 24 }, (_, i) => ({ port: i + 1, source: '', dest: '', notes: '' }));
    });
    return tac;
  }

  let data = emptyShow();
  data.fiberTac = initTacData();

  // Load from localStorage
  function loadFromStorage() {
    try {
      const saved = localStorage.getItem(STORAGE_KEY);
      if (saved) {
        const parsed = JSON.parse(saved);
        data = mergeDeep(emptyShow(), parsed);
        if (!data.fiberTac || Object.keys(data.fiberTac).length === 0) {
          data.fiberTac = initTacData();
        }
        // Ensure sources array always has 80 items
        if (!data.sources || !Array.isArray(data.sources) || data.sources.length < 80) {
          const defaultSources = emptyShow().sources;
          data.sources = data.sources || [];
          for (let i = 0; i < 80; i++) {
            if (!data.sources[i]) {
              data.sources[i] = defaultSources[i];
            } else {
              // Ensure each source has all required fields
              data.sources[i] = { ...defaultSources[i], ...data.sources[i] };
            }
          }
        }
      }
    } catch (e) {
      console.warn('Failed to load from localStorage:', e);
    }
  }

  function saveToStorage() {
    try {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
    } catch (e) {
      console.warn('Failed to save to localStorage:', e);
    }
  }

  // Deep merge utility
  function mergeDeep(target, source) {
    if (!source) return target;
    const output = { ...target };
    for (const key of Object.keys(source)) {
      if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {
        output[key] = mergeDeep(target[key] || {}, source[key]);
      } else {
        output[key] = source[key];
      }
    }
    return output;
  }

  // Event system
  function on(event, callback) {
    if (!listeners[event]) listeners[event] = [];
    listeners[event].push(callback);
  }

  function emit(event, payload) {
    (listeners[event] || []).forEach(cb => cb(payload));
  }

  // Public API
  return {
    get data() { return data; },

    get(path) {
      return path.split('.').reduce((obj, key) => obj?.[key], data);
    },

    set(path, value) {
      const keys = path.split('.');
      let obj = data;
      for (let i = 0; i < keys.length - 1; i++) {
        if (!obj[keys[i]]) obj[keys[i]] = {};
        obj = obj[keys[i]];
      }
      obj[keys[keys.length - 1]] = value;
      saveToStorage();
      emit('saved', Date.now());
      emit('change', { path, value });
      emit(`change:${keys[0]}`, { path, value });
    },

    loadShow(newData) {
      data = mergeDeep(emptyShow(), newData);
      if (!data.fiberTac || Object.keys(data.fiberTac).length === 0) {
        data.fiberTac = initTacData();
      }
      saveToStorage();
      emit('show-loaded', data);
    },

    newShow(name, format) {
      data = emptyShow();
      data.fiberTac = initTacData();
      data.show.name = name || '';
      data.show.format = format || '';
      saveToStorage();
      emit('show-loaded', data);
    },

    exportData() {
      return JSON.parse(JSON.stringify(data));
    },

    save() {
      saveToStorage();
    },

    on,
    emit,

    init() {
      loadFromStorage();
    },
  };
})();
